import streamlit as st
import pandas as pd
import plotly.express as px
import json
import re
from datetime import datetime
import random

# ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸ ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ†Ñ‹
st.set_page_config(layout="wide", page_title="ÐÐ½Ð°Ð»Ð¸Ñ‚Ð¸ÐºÐ° Ð¾Ñ‚Ð·Ñ‹Ð²Ð¾Ð² Ð¾ Ð“Ð°Ð·Ð¿Ñ€Ð¾Ð¼Ð±Ð°Ð½ÐºÐµ")

# Ð—Ð°Ð³Ð¾Ð»Ð¾Ð²Ð¾Ðº
st.title("ÐÐ½Ð°Ð»Ð¸Ñ‚Ð¸ÐºÐ° Ð¾Ñ‚Ð·Ñ‹Ð²Ð¾Ð² Ð¾ Ð“Ð°Ð·Ð¿Ñ€Ð¾Ð¼Ð±Ð°Ð½ÐºÐµ")

# Ð¡Ð°Ð¹Ð´Ð±Ð°Ñ€ Ð´Ð»Ñ Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ JSON Ð¸ Ñ„Ð¸Ð»ÑŒÑ‚Ñ€Ð¾Ð²
st.sidebar.header("Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° Ð¸ Ñ„Ð¸Ð»ÑŒÑ‚Ñ€Ñ‹")
uploaded_json = st.sidebar.file_uploader("Ð—Ð°Ð³Ñ€ÑƒÐ·Ð¸Ñ‚Ðµ JSON Ñ Ð¾Ñ‚Ð·Ñ‹Ð²Ð°Ð¼", type=['json'])

# Ð¤Ð¸Ð»ÑŒÑ‚Ñ€Ñ‹
if 'df' in locals():
    min_date = df['date'].min().date() if 'date' in df and pd.notna(df['date'].min()) else datetime(2024, 1, 1).date()
    max_date = df['date'].max().date() if 'date' in df and pd.notna(df['date'].max()) else datetime(2025, 10, 2).date()
    start_date = st.sidebar.date_input("ÐÐ°Ñ‡Ð°Ð»ÑŒÐ½Ð°Ñ Ð´Ð°Ñ‚Ð°", min_date, min_value=min_date, max_value=max_date)
    end_date = st.sidebar.date_input("ÐšÐ¾Ð½ÐµÑ‡Ð½Ð°Ñ Ð´Ð°Ñ‚Ð°", max_date, min_value=min_date, max_value=max_date)

    rating_filter = st.sidebar.slider("Ð ÐµÐ¹Ñ‚Ð¸Ð½Ð³", min_value=1, max_value=5, value=(1, 5))

    product_categories = ['Ð’ÑÐµ'] + sorted(['ÐŸÐ¾Ð²ÑÐµÐ´Ð½ÐµÐ²Ð½Ñ‹Ðµ Ñ„Ð¸Ð½Ð°Ð½ÑÑ‹ Ð¸ Ð¿Ð»Ð°Ñ‚ÐµÐ¶Ð¸', 'Ð¡Ð±ÐµÑ€ÐµÐ¶ÐµÐ½Ð¸Ñ Ð¸ Ð½Ð°ÐºÐ¾Ð¿Ð»ÐµÐ½Ð¸Ñ', 'ÐšÑ€ÐµÐ´Ð¸Ñ‚Ð¾Ð²Ð°Ð½Ð¸Ðµ', 'Ð˜Ð½Ð²ÐµÑÑ‚Ð¸Ñ†Ð¸Ð¸', 'Ð¡Ñ‚Ñ€Ð°Ñ…Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¸ Ð·Ð°Ñ‰Ð¸Ñ‚Ð°', 'ÐŸÑ€ÐµÐ¼Ð¸Ð°Ð»ÑŒÐ½Ñ‹Ðµ ÑƒÑÐ»ÑƒÐ³Ð¸'])
    product_filter = st.sidebar.multiselect("ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ Ð¿Ñ€Ð¾Ð´ÑƒÐºÑ‚Ð°", options=product_categories, default=['Ð’ÑÐµ'])

    subcategories = {
        'ÐŸÐ¾Ð²ÑÐµÐ´Ð½ÐµÐ²Ð½Ñ‹Ðµ Ñ„Ð¸Ð½Ð°Ð½ÑÑ‹ Ð¸ Ð¿Ð»Ð°Ñ‚ÐµÐ¶Ð¸': ['Ð’ÐµÐ´ÐµÐ½Ð¸Ðµ Ð²Ð°Ð»ÑŽÑ‚Ð½Ñ‹Ñ… ÑÑ‡ÐµÑ‚Ð¾Ð²', 'Ð”ÐµÐ±ÐµÑ‚Ð¾Ð²Ñ‹Ðµ ÐºÐ°Ñ€Ñ‚Ñ‹', 'ÐœÐ¾Ð±Ð¸Ð»ÑŒÐ½Ñ‹Ð¹ Ð±Ð°Ð½Ðº', 'ÐŸÐµÑ€ÐµÐ²Ð¾Ð´Ñ‹', 'Ð—Ð°Ñ€Ð¿Ð»Ð°Ñ‚Ð½Ñ‹Ðµ ÐºÐ°Ñ€Ñ‚Ñ‹'],
        'Ð¡Ð±ÐµÑ€ÐµÐ¶ÐµÐ½Ð¸Ñ Ð¸ Ð½Ð°ÐºÐ¾Ð¿Ð»ÐµÐ½Ð¸Ñ': ['Ð¡Ñ€Ð¾Ñ‡Ð½Ñ‹Ðµ Ð²ÐºÐ»Ð°Ð´Ñ‹', 'Ð¡Ð±ÐµÑ€ÐµÐ³Ð°Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ ÑÑ‡ÐµÑ‚Ð°', 'ÐžÐ±ÐµÐ·Ð»Ð¸Ñ‡ÐµÐ½Ð½Ñ‹Ðµ Ð¼ÐµÑ‚Ð°Ð»Ð»Ð¸Ñ‡ÐµÑÐºÐ¸Ðµ ÑÑ‡ÐµÑ‚Ð°', 'ÐÐ°ÐºÐ¾Ð¿Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ ÑÑ‡ÐµÑ‚Ð°'],
        'ÐšÑ€ÐµÐ´Ð¸Ñ‚Ð¾Ð²Ð°Ð½Ð¸Ðµ': ['ÐŸÐ¾Ñ‚Ñ€ÐµÐ±Ð¸Ñ‚ÐµÐ»ÑŒÑÐºÐ¸Ðµ ÐºÑ€ÐµÐ´Ð¸Ñ‚Ñ‹', 'ÐšÑ€ÐµÐ´Ð¸Ñ‚Ð½Ñ‹Ðµ ÐºÐ°Ñ€Ñ‚Ñ‹', 'Ð˜Ð¿Ð¾Ñ‚ÐµÑ‡Ð½Ñ‹Ðµ ÐºÑ€ÐµÐ´Ð¸Ñ‚Ñ‹', 'ÐÐ²Ñ‚Ð¾ÐºÑ€ÐµÐ´Ð¸Ñ‚Ñ‹', 'Ð ÐµÑ„Ð¸Ð½Ð°Ð½ÑÐ¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ'],
        'Ð˜Ð½Ð²ÐµÑÑ‚Ð¸Ñ†Ð¸Ð¸': ['Ð‘Ñ€Ð¾ÐºÐµÑ€ÑÐºÐ¸Ð¹ ÑÑ‡ÐµÑ‚', 'Ð˜Ð˜Ð¡ (Ð˜Ð½Ð´Ð¸Ð²Ð¸Ð´ÑƒÐ°Ð»ÑŒÐ½Ñ‹Ð¹ Ð¸Ð½Ð²ÐµÑÑ‚Ð¸Ñ†Ð¸Ð¾Ð½Ð½Ñ‹Ð¹ ÑÑ‡ÐµÑ‚)', 'ÐŸÐ˜Ð¤Ñ‹ (ÐŸÐ°ÐµÐ²Ñ‹Ðµ Ð¸Ð½Ð²ÐµÑÑ‚Ð¸Ñ†Ð¸Ð¾Ð½Ð½Ñ‹Ðµ Ñ„Ð¾Ð½Ð´Ñ‹)', 'Ð¡Ñ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð½Ñ‹Ðµ Ð¿Ñ€Ð¾Ð´ÑƒÐºÑ‚Ñ‹'],
        'Ð¡Ñ‚Ñ€Ð°Ñ…Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¸ Ð·Ð°Ñ‰Ð¸Ñ‚Ð°': ['Ð¡Ñ‚Ñ€Ð°Ñ…Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¿ÑƒÑ‚ÐµÑˆÐµÑÑ‚Ð²Ð¸Ð¹', 'Ð¡Ñ‚Ñ€Ð°Ñ…Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¸Ð¼ÑƒÑ‰ÐµÑÑ‚Ð²Ð°', 'Ð¡Ñ‚Ñ€Ð°Ñ…Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¾Ñ‚ Ð½ÐµÑÑ‡Ð°ÑÑ‚Ð½Ñ‹Ñ… ÑÐ»ÑƒÑ‡Ð°ÐµÐ² Ð¸ Ð±Ð¾Ð»ÐµÐ·Ð½ÐµÐ¹', 'Ð¡Ñ‚Ñ€Ð°Ñ…Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¿Ñ€Ð¸ Ð¾Ñ„Ð¾Ñ€Ð¼Ð»ÐµÐ½Ð¸Ð¸ ÐºÑ€ÐµÐ´Ð¸Ñ‚Ð¾Ð²'],
        'ÐŸÑ€ÐµÐ¼Ð¸Ð°Ð»ÑŒÐ½Ñ‹Ðµ ÑƒÑÐ»ÑƒÐ³Ð¸': ['ÐŸÑ€Ð¸Ð²Ð°Ñ‚ Ð±Ð°Ð½ÐºÐ¸Ð½Ð³', 'Ð”ÐµÐ¿Ð¾Ð·Ð¸Ñ‚Ð°Ñ€Ð½Ñ‹Ðµ ÑÑ‡ÐµÐ¹ÐºÐ¸', 'Ð£ÑÐ»ÑƒÐ³Ð¸ Ð¿Ð¾ ÐºÐ¾Ð½ÑÑƒÐ»ÑŒÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸ÑŽ Ð¸ Ð¿Ð»Ð°Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸ÑŽ']
    }
    subcat_filter = st.sidebar.multiselect("ÐŸÐ¾Ð´ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ Ð¿Ñ€Ð¾Ð´ÑƒÐºÑ‚Ð°", options=[subcat for cats in subcategories.values() for subcat in cats], default=[])

# Ð¡Ð»Ð¾Ð²Ð°Ñ€ÑŒ Ð´Ð»Ñ Ñ‚Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾ÑÑ‚Ð¸
SENTIMENT_LEXICON = {
    'positive': {
        'Ð¾Ñ‚Ð»Ð¸Ñ‡Ð½': 2, 'Ñ…Ð¾Ñ€Ð¾Ñˆ': 2, 'Ð¿Ñ€ÐµÐºÑ€Ð°ÑÐ½': 2, 'Ð±Ñ‹ÑÑ‚Ñ€': 1, 'ÑƒÐ´Ð¾Ð±Ð½': 1, 'Ð¿Ð¾Ð½ÑÑ‚Ð½': 1,
        'Ñ€ÐµÐºÐ¾Ð¼ÐµÐ½Ð´': 2, 'Ð´Ð¾Ð²Ð¾Ð»': 2, 'ÑÐ¿Ð°ÑÐ¸Ð±': 2, 'Ñ€Ð°Ð´': 2, 'Ð»ÐµÐ³Ðº': 1, 'Ð¿Ñ€Ð¸ÑÑ‚Ð½': 1,
        'ÐºÐ°Ñ‡ÐµÑÑ‚Ð²ÐµÐ½': 2, 'Ð¿Ñ€Ð¾Ñ„ÐµÑÑÐ¸Ð¾Ð½Ð°Ð»': 2, 'Ð¾Ð¿ÐµÑ€Ð°Ñ‚Ð¸Ð²': 1, 'Ñ‡ÐµÑ‚Ðº': 1, 'Ð¿Ñ€Ð¾Ð·Ñ€Ð°Ñ‡Ð½': 1,
        'Ð²Ñ‹Ð³Ð¾Ð´Ð½': 2, 'Ð½Ð°Ð´ÐµÐ¶Ð½': 2, 'Ð»ÑƒÑ‡Ñˆ': 2, 'ÑÑƒÐ¿ÐµÑ€': 2, 'Ð·Ð°Ð¼ÐµÑ‡Ð°Ñ‚ÐµÐ»ÑŒÐ½': 2, 'Ð²Ð¿ÐµÑ‡Ð°Ñ‚Ð»': 2,
        'ÑƒÐ´Ð¾Ð²Ð»ÐµÑ‚Ð²Ð¾Ñ€ÐµÐ½': 2, 'Ð¿Ð¾Ð½Ñ€Ð°Ð²Ð¸Ð»Ð¾ÑÑŒ': 2, 'Ð½Ñ€Ð°Ð²Ð¸Ñ‚ÑÑ': 2, 'Ð²Ð¾Ð²Ñ€ÐµÐ¼Ñ': 1, 'ÑÐ²Ð¾ÐµÐ²Ñ€ÐµÐ¼ÐµÐ½': 1,
        'Ð³Ð»Ð°Ð´ÐºÐ¾': 1, 'ÑÑ„Ñ„ÐµÐºÑ‚Ð¸Ð²Ð½': 1, 'Ð±ÐµÐ· Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼': 2, 'Ð½Ðµ Ð¿Ð»Ð¾Ñ…Ð¾': 1, 'Ð±ÐµÐ· Ð¾ÑˆÐ¸Ð±Ð¾Ðº': 2,
        'Ð½Ðµ Ð¼ÐµÐ´Ð»ÐµÐ½': 1, 'Ð½Ðµ Ð·Ð°Ð²Ð¸ÑÐ°ÐµÑ‚': 2
    },
    'negative': {
        'Ð¿Ð»Ð¾Ñ…': -2, 'ÑƒÐ¶Ð°ÑÐ½': -3, 'Ð¼ÐµÐ´Ð»ÐµÐ½': -2, 'Ð½ÐµÑƒÐ´Ð¾Ð±Ð½': -2, 'ÑÐ»Ð¾Ð¶Ð½': -2, 'Ð½Ðµ Ð½Ñ€Ð°Ð²Ð¸Ñ‚ÑÑ': -3,
        'Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼': -2, 'Ð¾ÑˆÐ¸Ð±Ðº': -2, 'Ð³Ð»ÑŽÐº': -2, 'Ð·Ð°Ð²Ð¸ÑÐ°': -2, 'Ð½Ðµ Ñ€Ð°Ð±Ð¾Ñ‚': -3, 'Ð¾Ñ‚ÐºÐ°Ð·': -2,
        'Ð¾Ð±Ð¼Ð°Ð½': -3, 'Ð´Ð¾Ñ€Ð¾Ð³': -2, 'ÐºÐ¾Ð¼Ð¸ÑÑ': -1, 'Ð´Ð¾Ð»Ð³': -2, 'Ð½ÐµÑÑÐ½': -1, 'Ð½ÐµÐ¿Ð¾Ð»Ð°Ð´Ðº': -2,
        'Ð½ÐµÐ´Ð¾Ð²Ð¾Ð»': -2, 'Ñ€Ð°Ð·Ð¾Ñ‡Ð°Ñ€Ð¾Ð²Ð°Ð½': -3, 'ÐºÐ¾ÑˆÐ¼Ð°Ñ€': -3, 'Ð·Ð°Ð²Ð¸ÑÐ°ÐµÑ‚': -2, 'Ð²Ð¸ÑÐ½ÐµÑ‚': -2, 'Ñ‚ÑƒÐ¿Ð¸Ñ‚': -2,
        'Ð»Ð°Ð³Ð°ÐµÑ‚': -2, 'Ð¼Ð°Ð»ÐµÐ½ÑŒÐº': -1
    },
    'neutral': {
        'Ð½Ð¾Ñ€Ð¼Ð°Ð»ÑŒÐ½': 0, 'Ð¾Ð±Ñ‹Ñ‡Ð½': 0, 'ÑÑ‚Ð°Ð½Ð´Ð°Ñ€Ñ‚Ð½': 0, 'Ð¿Ñ€Ð¸ÐµÐ¼Ð»ÐµÐ¼': 0, 'Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½': 0,
        'Ð¾Ð¶Ð¸Ð´Ð°': 0, 'ÑÑ€ÐµÐ´Ð½': 0, 'Ñ€Ð°Ð±Ð¾Ñ‚': 0, 'Ð½ÐµÐ¹Ñ‚Ñ€Ð°Ð»ÑŒÐ½': 0
    }
}

INTENSIFIERS = {
    'Ð¾Ñ‡ÐµÐ½ÑŒ': 1.5, 'ÐºÑ€Ð°Ð¹Ð½Ðµ': 2, 'ÑÐ¾Ð²ÑÐµÐ¼': 1.5, 'Ð°Ð±ÑÐ¾Ð»ÑŽÑ‚Ð½Ð¾': 2, 'Ð¿Ð¾Ð»Ð½Ð¾ÑÑ‚ÑŒÑŽ': 1.5, 'ÑÐ¸Ð»ÑŒÐ½Ð¾': 1.5,
    'Ñ‡Ñ€ÐµÐ·Ð²Ñ‹Ñ‡Ð°Ð¹Ð½Ð¾': 2, 'Ð½ÐµÐ²ÐµÑ€Ð¾ÑÑ‚Ð½Ð¾': 2, 'ÑƒÐ´Ð¸Ð²Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾': 1.5, 'Ð½ÐµÐ¾Ð±Ñ‹Ñ‡Ð½Ð¾': 1.5, 'Ð²ÐµÑÑŒÐ¼Ð°': 1.5,
    'ÑÐ»Ð¸ÑˆÐºÐ¾Ð¼': 2, 'Ñ‡Ð°ÑÑ‚Ð¾': 1
}

NEGATION_WORDS = {
    'Ð½Ðµ', 'Ð½ÐµÑ‚', 'Ð½Ð¸', 'Ð±ÐµÐ·', 'Ð½ÐµÐ»ÑŒÐ·Ñ', 'Ð½ÐµÐ²Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾', 'Ð½Ð¸ÐºÐ°Ðº', 'Ð½Ð¸Ñ‡ÑƒÑ‚ÑŒ'
}

# Ð¡Ð»Ð¾Ð²Ð°Ñ€ÑŒ Ð´Ð»Ñ Ñ‚ÐµÐ¼ (topics)
PRODUCT_CATEGORIES_TOPICS = {
    'ÐžÐ±ÑÐ»ÑƒÐ¶Ð¸Ð²Ð°Ð½Ð¸Ðµ': {'keywords': ['Ð¾Ð±ÑÐ»ÑƒÐ¶Ð¸Ð²Ð°Ð½', 'Ð¾Ñ‚Ð´ÐµÐ»ÐµÐ½Ð¸', 'ÐºÐ»Ð¸ÐµÐ½Ñ‚', 'Ð¿ÐµÑ€ÑÐ¾Ð½Ð°Ð»', 'Ð¼ÐµÐ½ÐµÐ´Ð¶ÐµÑ€', 'ÐºÐ¾Ð½ÑÑƒÐ»ÑŒÑ‚Ð°Ð½Ñ‚'], 'phrases': ['Ð¾Ð±ÑÐ»ÑƒÐ¶Ð¸Ð²Ð°Ð½Ð¸Ðµ Ð² Ð±Ð°Ð½ÐºÐµ', 'Ð¾Ñ‚Ð´ÐµÐ»ÐµÐ½Ð¸Ðµ Ð±Ð°Ð½ÐºÐ°']},
    'ÐœÐ¾Ð±Ð¸Ð»ÑŒÐ½Ð¾Ðµ Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ðµ': {'keywords': ['Ð¼Ð¾Ð±Ð¸Ð»ÑŒ', 'Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½', 'Ð¾Ð½Ð»Ð°Ð¹Ð½', 'Ð¸Ð½Ñ‚ÐµÑ€Ð½ÐµÑ‚', 'Ð·Ð°Ð²Ð¸ÑÐ°'], 'phrases': ['Ð¼Ð¾Ð±Ð¸Ð»ÑŒÐ½Ð¾Ðµ Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ðµ', 'Ð¼Ð¾Ð±Ð¸Ð»ÑŒÐ½Ñ‹Ð¹ Ð±Ð°Ð½Ðº']},
    'ÐšÑ€ÐµÐ´Ð¸Ñ‚Ð½Ð°Ñ ÐºÐ°Ñ€Ñ‚Ð°': {'keywords': ['ÐºÑ€ÐµÐ´Ð¸Ñ‚Ð½', 'Ð»Ð¸Ð¼Ð¸Ñ‚', 'Ð¾Ð´Ð¾Ð±Ñ€ÐµÐ½'], 'phrases': ['ÐºÑ€ÐµÐ´Ð¸Ñ‚Ð½Ð°Ñ ÐºÐ°Ñ€Ñ‚Ð°']}
}

# Ð¡Ð»Ð¾Ð²Ð°Ñ€ÑŒ Ð´Ð»Ñ ÐºÐ»Ð°ÑÑÐ¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸Ð¸ Ð¿Ñ€Ð¾Ð´ÑƒÐºÑ‚Ð¾Ð² Ñ Ð¿Ð¾Ð´ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸ÑÐ¼Ð¸
PRODUCT_CATEGORIES_MAIN = {
    'ÐŸÐ¾Ð²ÑÐµÐ´Ð½ÐµÐ²Ð½Ñ‹Ðµ Ñ„Ð¸Ð½Ð°Ð½ÑÑ‹ Ð¸ Ð¿Ð»Ð°Ñ‚ÐµÐ¶Ð¸': {
        'subcategories': {
            'Ð’ÐµÐ´ÐµÐ½Ð¸Ðµ Ð²Ð°Ð»ÑŽÑ‚Ð½Ñ‹Ñ… ÑÑ‡ÐµÑ‚Ð¾Ð²': {'keywords': ['Ð²Ð°Ð»ÑŽÑ‚', 'ÑÑ‡ÐµÑ‚', 'ÐºÐ¾Ð½Ð²ÐµÑ€Ñ‚Ð°Ñ†'], 'phrases': ['Ð²Ð°Ð»ÑŽÑ‚Ð½Ñ‹Ð¹ ÑÑ‡ÐµÑ‚']},
            'Ð”ÐµÐ±ÐµÑ‚Ð¾Ð²Ñ‹Ðµ ÐºÐ°Ñ€Ñ‚Ñ‹': {'keywords': ['Ð´ÐµÐ±ÐµÑ‚', 'ÑÐ½ÑÑ‚Ð¸Ðµ', 'ÐºÑÑˆÐ±ÑÐº'], 'phrases': ['Ð´ÐµÐ±ÐµÑ‚Ð¾Ð²Ð°Ñ ÐºÐ°Ñ€Ñ‚Ð°']},
            'ÐœÐ¾Ð±Ð¸Ð»ÑŒÐ½Ñ‹Ð¹ Ð±Ð°Ð½Ðº': {'keywords': ['Ð¼Ð¾Ð±Ð¸Ð»ÑŒ', 'Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½', 'Ð¾Ð½Ð»Ð°Ð¹Ð½'], 'phrases': ['Ð¼Ð¾Ð±Ð¸Ð»ÑŒÐ½Ñ‹Ð¹ Ð±Ð°Ð½Ðº']},
            'ÐŸÐµÑ€ÐµÐ²Ð¾Ð´Ñ‹': {'keywords': ['Ð¿ÐµÑ€ÐµÐ²Ð¾Ð´', 'ÑÑ€ÐµÐ´ÑÑ‚Ð²'], 'phrases': ['Ð¿ÐµÑ€ÐµÐ²Ð¾Ð´ Ð´ÐµÐ½ÐµÐ³']},
            'Ð—Ð°Ñ€Ð¿Ð»Ð°Ñ‚Ð½Ñ‹Ðµ ÐºÐ°Ñ€Ñ‚Ñ‹': {'keywords': ['Ð·Ð°Ñ€Ð¿Ð»Ð°Ñ‚'], 'phrases': ['Ð·Ð°Ñ€Ð¿Ð»Ð°Ñ‚Ð½Ð°Ñ ÐºÐ°Ñ€Ñ‚Ð°']}
        },
        'keywords': ['Ð¿ÐµÑ€ÐµÐ²Ð¾Ð´', 'Ð·Ð°Ñ€Ð¿Ð»Ð°Ñ‚', 'Ð¼Ð¾Ð±Ð¸Ð»ÑŒ', 'ÑÑ‡ÐµÑ‚', 'Ð¿Ð»Ð°Ñ‚ÐµÐ¶', 'Ð²Ð°Ð»ÑŽÑ‚', 'ÑÐ½ÑÑ‚', 'Ð±Ð°Ð½ÐºÐ¾Ð¼Ð°Ñ‚', 'Ð¾Ð¿Ð»Ð°Ñ‚', 'ÐºÐ¾Ð¼Ð¸ÑÑ', 'Ð¾Ð½Ð»Ð°Ð¹Ð½', 'Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½', 'Ð¸Ð½Ñ‚ÐµÑ€Ð½ÐµÑ‚', 'ÑƒÐ²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½', 'Ð´ÐµÐ½ÑŒÐ³', 'Ð½Ð°Ð»Ð¸Ñ‡', 'Ð±ÐµÐ·Ð½Ð°Ð»', 'Ð²Ñ‹Ð¿Ð¸Ñ', 'Ð±Ð°Ð»Ð°Ð½Ñ', 'Ð¾ÑÑ‚Ð°Ñ‚Ð¾Ðº'],
        'phrases': ['Ð¼Ð¾Ð±Ð¸Ð»ÑŒÐ½Ñ‹Ð¹ Ð±Ð°Ð½Ðº', 'Ð¿ÐµÑ€ÐµÐ²Ð¾Ð´ Ð´ÐµÐ½ÐµÐ³', 'Ð¾Ñ‚ÐºÑ€Ñ‹Ñ‚ÑŒ ÑÑ‡ÐµÑ‚', 'Ð²Ð°Ð»ÑŽÑ‚Ð½Ñ‹Ð¹ ÑÑ‡ÐµÑ‚', 'ÑÐ½ÑÑ‚ÑŒ Ð´ÐµÐ½ÑŒÐ³Ð¸', 'Ð¾Ð¿Ð»Ð°Ñ‚Ð¸Ñ‚ÑŒ ÑƒÑÐ»ÑƒÐ³Ð¸', 'Ð¾Ð±ÑÐ»ÑƒÐ¶Ð¸Ð²Ð°Ð½Ð¸Ðµ ÐºÐ°Ñ€Ñ‚Ñ‹', 'Ð¾Ñ‚Ð´ÐµÐ»ÐµÐ½Ð¸Ðµ Ð±Ð°Ð½ÐºÐ°', 'Ð¸Ð½Ñ‚ÐµÑ€Ð½ÐµÑ‚ Ð±Ð°Ð½Ðº', 'Ð¼Ð¾Ð±Ð¸Ð»ÑŒÐ½Ð¾Ðµ Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ðµ', 'Ð²Ñ‹Ð¿Ð¸ÑÐºÐ° Ð¿Ð¾ ÑÑ‡ÐµÑ‚Ñƒ', 'Ð¾ÑÑ‚Ð°Ñ‚Ð¾Ðº Ð½Ð° ÑÑ‡ÐµÑ‚Ðµ']
    },
    'Ð¡Ð±ÐµÑ€ÐµÐ¶ÐµÐ½Ð¸Ñ Ð¸ Ð½Ð°ÐºÐ¾Ð¿Ð»ÐµÐ½Ð¸Ñ': {
        'subcategories': {
            'Ð¡Ñ€Ð¾Ñ‡Ð½Ñ‹Ðµ Ð²ÐºÐ»Ð°Ð´Ñ‹': {'keywords': ['ÑÑ€Ð¾Ñ‡Ð½', 'Ð²ÐºÐ»Ð°Ð´'], 'phrases': ['ÑÑ€Ð¾Ñ‡Ð½Ñ‹Ð¹ Ð²ÐºÐ»Ð°Ð´']},
            'Ð¡Ð±ÐµÑ€ÐµÐ³Ð°Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ ÑÑ‡ÐµÑ‚Ð°': {'keywords': ['ÑÐ±ÐµÑ€ÐµÐ³Ð°Ñ‚ÐµÐ»ÑŒÐ½', 'ÑÑ‡ÐµÑ‚'], 'phrases': ['ÑÐ±ÐµÑ€ÐµÐ³Ð°Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ð¹ ÑÑ‡ÐµÑ‚']},
            'ÐžÐ±ÐµÐ·Ð»Ð¸Ñ‡ÐµÐ½Ð½Ñ‹Ðµ Ð¼ÐµÑ‚Ð°Ð»Ð»Ð¸Ñ‡ÐµÑÐºÐ¸Ðµ ÑÑ‡ÐµÑ‚Ð°': {'keywords': ['Ð¼ÐµÑ‚Ð°Ð»Ð»', 'Ð¾Ð±ÐµÐ·Ð»Ð¸Ñ‡ÐµÐ½'], 'phrases': ['Ð¾Ð±ÐµÐ·Ð»Ð¸Ñ‡ÐµÐ½Ð½Ñ‹Ð¹ Ð¼ÐµÑ‚Ð°Ð»Ð»Ð¸Ñ‡ÐµÑÐºÐ¸Ð¹']},
            'ÐÐ°ÐºÐ¾Ð¿Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ ÑÑ‡ÐµÑ‚Ð°': {'keywords': ['Ð½Ð°ÐºÐ¾Ð¿Ð¸Ñ‚', 'ÑÑ‡ÐµÑ‚'], 'phrases': ['Ð½Ð°ÐºÐ¾Ð¿Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ð¹ ÑÑ‡ÐµÑ‚']}
        },
        'keywords': ['Ð²ÐºÐ»Ð°Ð´', 'ÑÐ±ÐµÑ€ÐµÐ³Ð°Ñ‚ÐµÐ»ÑŒÐ½', 'Ð½Ð°ÐºÐ¾Ð¿Ð¸Ñ‚', 'Ð¼ÐµÑ‚Ð°Ð»Ð»', 'ÑÑ‡ÐµÑ‚', 'Ð¿Ñ€Ð¾Ñ†ÐµÐ½Ñ‚', 'Ð´ÐµÐ¿Ð¾Ð·Ð¸Ñ‚', 'ÑÑ‚Ð°Ð²Ðº', 'Ð´Ð¾Ñ…Ð¾Ð´Ð½Ð¾ÑÑ‚', 'Ð¿Ð¾Ð¿Ð¾Ð»Ð½ÐµÐ½', 'ÑÐ½ÑÑ‚', 'Ð½Ð°Ñ‡Ð¸ÑÐ»ÐµÐ½'],
        'phrases': ['ÑÑ€Ð¾Ñ‡Ð½Ñ‹Ð¹ Ð²ÐºÐ»Ð°Ð´', 'ÑÐ±ÐµÑ€ÐµÐ³Ð°Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ð¹ ÑÑ‡ÐµÑ‚', 'Ð¼ÐµÑ‚Ð°Ð»Ð»Ð¸Ñ‡ÐµÑÐºÐ¸Ð¹ ÑÑ‡ÐµÑ‚', 'Ð½Ð°ÐºÐ¾Ð¿Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ð¹ ÑÑ‡ÐµÑ‚', 'Ð±Ð°Ð½ÐºÐ¾Ð²ÑÐºÐ¸Ð¹ Ð²ÐºÐ»Ð°Ð´', 'Ð¿Ñ€Ð¾Ñ†ÐµÐ½Ñ‚Ð½Ð°Ñ ÑÑ‚Ð°Ð²ÐºÐ°', 'Ð´Ð¾Ñ…Ð¾Ð´ Ð¿Ð¾ Ð²ÐºÐ»Ð°Ð´Ñƒ']
    },
    'ÐšÑ€ÐµÐ´Ð¸Ñ‚Ð¾Ð²Ð°Ð½Ð¸Ðµ': {
        'subcategories': {
            'ÐŸÐ¾Ñ‚Ñ€ÐµÐ±Ð¸Ñ‚ÐµÐ»ÑŒÑÐºÐ¸Ðµ ÐºÑ€ÐµÐ´Ð¸Ñ‚Ñ‹': {'keywords': ['Ð¿Ð¾Ñ‚Ñ€ÐµÐ±Ð¸Ñ‚ÐµÐ»ÑŒÑÐº', 'ÐºÑ€ÐµÐ´Ð¸Ñ‚'], 'phrases': ['Ð¿Ð¾Ñ‚Ñ€ÐµÐ±Ð¸Ñ‚ÐµÐ»ÑŒÑÐºÐ¸Ð¹ ÐºÑ€ÐµÐ´Ð¸Ñ‚']},
            'ÐšÑ€ÐµÐ´Ð¸Ñ‚Ð½Ñ‹Ðµ ÐºÐ°Ñ€Ñ‚Ñ‹': {'keywords': ['ÐºÑ€ÐµÐ´Ð¸Ñ‚Ð½', 'ÐºÐ°Ñ€Ñ‚Ð°'], 'phrases': ['ÐºÑ€ÐµÐ´Ð¸Ñ‚Ð½Ð°Ñ ÐºÐ°Ñ€Ñ‚Ð°']},
            'Ð˜Ð¿Ð¾Ñ‚ÐµÑ‡Ð½Ñ‹Ðµ ÐºÑ€ÐµÐ´Ð¸Ñ‚Ñ‹': {'keywords': ['Ð¸Ð¿Ð¾Ñ‚ÐµÐº'], 'phrases': ['Ð¸Ð¿Ð¾Ñ‚ÐµÑ‡Ð½Ñ‹Ð¹ ÐºÑ€ÐµÐ´Ð¸Ñ‚']},
            'ÐÐ²Ñ‚Ð¾ÐºÑ€ÐµÐ´Ð¸Ñ‚Ñ‹': {'keywords': ['Ð°Ð²Ñ‚Ð¾ÐºÑ€ÐµÐ´Ð¸Ñ‚'], 'phrases': ['Ð°Ð²Ñ‚Ð¾Ð¼Ð¾Ð±Ð¸Ð»ÑŒÐ½Ñ‹Ð¹ ÐºÑ€ÐµÐ´Ð¸Ñ‚']},
            'Ð ÐµÑ„Ð¸Ð½Ð°Ð½ÑÐ¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ': {'keywords': ['Ñ€ÐµÑ„Ð¸Ð½Ð°Ð½ÑÐ¸Ñ€Ð¾Ð²Ð°Ð½'], 'phrases': ['Ñ€ÐµÑ„Ð¸Ð½Ð°Ð½ÑÐ¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ ÐºÑ€ÐµÐ´Ð¸Ñ‚Ð°']}
        },
        'keywords': ['ÐºÑ€ÐµÐ´Ð¸Ñ‚', 'Ð¸Ð¿Ð¾Ñ‚ÐµÐº', 'Ð°Ð²Ñ‚Ð¾ÐºÑ€ÐµÐ´Ð¸Ñ‚', 'Ñ€ÐµÑ„Ð¸Ð½Ð°Ð½ÑÐ¸Ñ€Ð¾Ð²Ð°Ð½', 'Ð·Ð°ÐµÐ¼', 'Ð¿Ð»Ð°Ñ‚ÐµÐ¶', 'Ð¿Ñ€Ð¾Ñ†ÐµÐ½Ñ‚', 'ÑÑ‚Ð°Ð²Ðº', 'Ð¾Ð´Ð¾Ð±Ñ€ÐµÐ½', 'Ð¿Ð¾Ð³Ð°ÑˆÐµÐ½', 'Ð´Ð¾Ð»Ð³', 'Ð¿Ñ€Ð¾ÑÑ€Ð¾Ñ‡Ðº'],
        'phrases': ['Ð¿Ð¾Ñ‚Ñ€ÐµÐ±Ð¸Ñ‚ÐµÐ»ÑŒÑÐºÐ¸Ð¹ ÐºÑ€ÐµÐ´Ð¸Ñ‚', 'Ð¸Ð¿Ð¾Ñ‚ÐµÑ‡Ð½Ñ‹Ð¹ ÐºÑ€ÐµÐ´Ð¸Ñ‚', 'ÐºÑ€ÐµÐ´Ð¸Ñ‚Ð½Ð°Ñ ÐºÐ°Ñ€Ñ‚Ð°', 'Ñ€ÐµÑ„Ð¸Ð½Ð°Ð½ÑÐ¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ ÐºÑ€ÐµÐ´Ð¸Ñ‚Ð°', 'Ð°Ð²Ñ‚Ð¾Ð¼Ð¾Ð±Ð¸Ð»ÑŒÐ½Ñ‹Ð¹ ÐºÑ€ÐµÐ´Ð¸Ñ‚', 'Ð¿Ð¾Ð³Ð°ÑˆÐµÐ½Ð¸Ðµ ÐºÑ€ÐµÐ´Ð¸Ñ‚Ð°', 'Ð¿Ñ€Ð¾Ñ†ÐµÐ½Ñ‚Ð½Ð°Ñ ÑÑ‚Ð°Ð²ÐºÐ°']
    },
    'Ð˜Ð½Ð²ÐµÑÑ‚Ð¸Ñ†Ð¸Ð¸': {
        'subcategories': {
            'Ð‘Ñ€Ð¾ÐºÐµÑ€ÑÐºÐ¸Ð¹ ÑÑ‡ÐµÑ‚': {'keywords': ['Ð±Ñ€Ð¾ÐºÐµÑ€', 'ÑÑ‡ÐµÑ‚'], 'phrases': ['Ð±Ñ€Ð¾ÐºÐµÑ€ÑÐºÐ¸Ð¹ ÑÑ‡ÐµÑ‚']},
            'Ð˜Ð˜Ð¡ (Ð˜Ð½Ð´Ð¸Ð²Ð¸Ð´ÑƒÐ°Ð»ÑŒÐ½Ñ‹Ð¹ Ð¸Ð½Ð²ÐµÑÑ‚Ð¸Ñ†Ð¸Ð¾Ð½Ð½Ñ‹Ð¹ ÑÑ‡ÐµÑ‚)': {'keywords': ['Ð¸Ð¸Ñ'], 'phrases': ['Ð¸Ð½Ð´Ð¸Ð²Ð¸Ð´ÑƒÐ°Ð»ÑŒÐ½Ñ‹Ð¹ Ð¸Ð½Ð²ÐµÑÑ‚Ð¸Ñ†Ð¸Ð¾Ð½Ð½Ñ‹Ð¹ ÑÑ‡ÐµÑ‚']},
            'ÐŸÐ˜Ð¤Ñ‹ (ÐŸÐ°ÐµÐ²Ñ‹Ðµ Ð¸Ð½Ð²ÐµÑÑ‚Ð¸Ñ†Ð¸Ð¾Ð½Ð½Ñ‹Ðµ Ñ„Ð¾Ð½Ð´Ñ‹)': {'keywords': ['Ð¿Ð¸Ñ„'], 'phrases': ['Ð¿Ð°ÐµÐ²Ð¾Ð¹ Ñ„Ð¾Ð½Ð´']},
            'Ð¡Ñ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð½Ñ‹Ðµ Ð¿Ñ€Ð¾Ð´ÑƒÐºÑ‚Ñ‹': {'keywords': ['ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð½'], 'phrases': ['ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð½Ñ‹Ð¹ Ð¿Ñ€Ð¾Ð´ÑƒÐºÑ‚']}
        },
        'keywords': ['Ð¸Ð½Ð²ÐµÑÑ‚', 'Ð±Ñ€Ð¾ÐºÐµÑ€', 'Ð¸Ð¸Ñ', 'Ð¿Ð¸Ñ„', 'Ð°ÐºÑ†Ð¸', 'Ð¾Ð±Ð»Ð¸Ð³Ð°Ñ†', 'Ð¿Ð¾Ñ€Ñ‚Ñ„ÐµÐ»ÑŒ', 'Ð´Ð¾Ñ…Ð¾Ð´Ð½Ð¾ÑÑ‚', 'ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð½', 'Ñ‚Ð¾Ñ€Ð³Ð¾Ð²', 'Ð´Ð¸Ð²Ð¸Ð´ÐµÐ½Ð´'],
        'phrases': ['Ð±Ñ€Ð¾ÐºÐµÑ€ÑÐºÐ¸Ð¹ ÑÑ‡ÐµÑ‚', 'Ð¸Ð½Ð´Ð¸Ð²Ð¸Ð´ÑƒÐ°Ð»ÑŒÐ½Ñ‹Ð¹ Ð¸Ð½Ð²ÐµÑÑ‚Ð¸Ñ†Ð¸Ð¾Ð½Ð½Ñ‹Ð¹ ÑÑ‡ÐµÑ‚', 'Ð¿Ð°ÐµÐ²Ð¾Ð¹ Ñ„Ð¾Ð½Ð´', 'ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð½Ñ‹Ð¹ Ð¿Ñ€Ð¾Ð´ÑƒÐºÑ‚', 'Ð¸Ð½Ð²ÐµÑÑ‚Ð¸Ñ†Ð¸Ð¾Ð½Ð½Ñ‹Ð¹ Ð¿Ð¾Ñ€Ñ‚Ñ„ÐµÐ»ÑŒ', 'Ñ‚Ð¾Ñ€Ð³Ð¾Ð²Ð»Ñ Ð½Ð° Ð±Ð¸Ñ€Ð¶Ðµ']
    },
    'Ð¡Ñ‚Ñ€Ð°Ñ…Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¸ Ð·Ð°Ñ‰Ð¸Ñ‚Ð°': {
        'subcategories': {
            'Ð¡Ñ‚Ñ€Ð°Ñ…Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¿ÑƒÑ‚ÐµÑˆÐµÑÑ‚Ð²Ð¸Ð¹': {'keywords': ['Ð¿ÑƒÑ‚ÐµÑˆÐµÑÑ‚Ð²Ð¸'], 'phrases': ['ÑÑ‚Ñ€Ð°Ñ…Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¿ÑƒÑ‚ÐµÑˆÐµÑÑ‚Ð²Ð¸Ð¹']},
            'Ð¡Ñ‚Ñ€Ð°Ñ…Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¸Ð¼ÑƒÑ‰ÐµÑÑ‚Ð²Ð°': {'keywords': ['Ð¸Ð¼ÑƒÑ‰ÐµÑÑ‚Ð²'], 'phrases': ['ÑÑ‚Ñ€Ð°Ñ…Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¸Ð¼ÑƒÑ‰ÐµÑÑ‚Ð²Ð°']},
            'Ð¡Ñ‚Ñ€Ð°Ñ…Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¾Ñ‚ Ð½ÐµÑÑ‡Ð°ÑÑ‚Ð½Ñ‹Ñ… ÑÐ»ÑƒÑ‡Ð°ÐµÐ² Ð¸ Ð±Ð¾Ð»ÐµÐ·Ð½ÐµÐ¹': {'keywords': ['Ð½ÐµÑÑ‡Ð°ÑÑ‚Ð½', 'Ð±Ð¾Ð»ÐµÐ·Ð½'], 'phrases': ['ÑÑ‚Ñ€Ð°Ñ…Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¾Ñ‚ Ð½ÐµÑÑ‡Ð°ÑÑ‚Ð½Ñ‹Ñ… ÑÐ»ÑƒÑ‡Ð°ÐµÐ²']},
            'Ð¡Ñ‚Ñ€Ð°Ñ…Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¿Ñ€Ð¸ Ð¾Ñ„Ð¾Ñ€Ð¼Ð»ÐµÐ½Ð¸Ð¸ ÐºÑ€ÐµÐ´Ð¸Ñ‚Ð¾Ð²': {'keywords': ['ÐºÑ€ÐµÐ´Ð¸Ñ‚', 'ÑÑ‚Ñ€Ð°Ñ…Ð¾Ð²Ð°Ð½'], 'phrases': ['ÑÑ‚Ñ€Ð°Ñ…Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¿Ñ€Ð¸ Ð¾Ñ„Ð¾Ñ€Ð¼Ð»ÐµÐ½Ð¸Ð¸ ÐºÑ€ÐµÐ´Ð¸Ñ‚Ð°']}
        },
        'keywords': ['ÑÑ‚Ñ€Ð°Ñ…Ð¾Ð²Ðº', 'Ð¿Ð¾Ð»Ð¸Ñ', 'Ð²Ñ‹Ð¿Ð»Ð°Ñ‚', 'ÑƒÑ‰ÐµÑ€Ð±', 'Ñ€Ð¸ÑÐº', 'Ð¾Ñ„Ð¾Ñ€Ð¼Ð»ÐµÐ½'],
        'phrases': ['ÑÑ‚Ñ€Ð°Ñ…Ð¾Ð²Ð¾Ð¹ Ð¿Ð¾Ð»Ð¸Ñ', 'Ð¾Ñ„Ð¾Ñ€Ð¼Ð»ÐµÐ½Ð¸Ðµ ÑÑ‚Ñ€Ð°Ñ…Ð¾Ð²ÐºÐ¸', 'Ð²Ñ‹Ð¿Ð»Ð°Ñ‚Ð° Ð¿Ð¾ ÑÑ‚Ñ€Ð°Ñ…Ð¾Ð²ÐºÐµ', 'Ð²Ð¾Ð·Ð¼ÐµÑ‰ÐµÐ½Ð¸Ðµ ÑƒÑ‰ÐµÑ€Ð±Ð°']
    },
    'ÐŸÑ€ÐµÐ¼Ð¸Ð°Ð»ÑŒÐ½Ñ‹Ðµ ÑƒÑÐ»ÑƒÐ³Ð¸': {
        'subcategories': {
            'ÐŸÑ€Ð¸Ð²Ð°Ñ‚ Ð±Ð°Ð½ÐºÐ¸Ð½Ð³': {'keywords': ['Ð¿Ñ€Ð¸Ð²Ð°Ñ‚'], 'phrases': ['Ð¿Ñ€Ð¸Ð²Ð°Ñ‚-Ð±Ð°Ð½ÐºÐ¸Ð½Ð³']},
            'Ð”ÐµÐ¿Ð¾Ð·Ð¸Ñ‚Ð°Ñ€Ð½Ñ‹Ðµ ÑÑ‡ÐµÐ¹ÐºÐ¸': {'keywords': ['ÑÑ‡ÐµÐ¹Ðº'], 'phrases': ['Ð´ÐµÐ¿Ð¾Ð·Ð¸Ñ‚Ð°Ñ€Ð½Ñ‹Ðµ ÑÑ‡ÐµÐ¹ÐºÐ¸']},
            'Ð£ÑÐ»ÑƒÐ³Ð¸ Ð¿Ð¾ ÐºÐ¾Ð½ÑÑƒÐ»ÑŒÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸ÑŽ Ð¸ Ð¿Ð»Ð°Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸ÑŽ': {'keywords': ['ÐºÐ¾Ð½ÑÑƒÐ»ÑŒÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½', 'Ð¿Ð»Ð°Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½'], 'phrases': ['ÑƒÑÐ»ÑƒÐ³Ð¸ Ð¿Ð¾ ÐºÐ¾Ð½ÑÑƒÐ»ÑŒÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸ÑŽ']}
        },
        'keywords': ['Ð¿Ñ€ÐµÐ¼Ð¸ÑƒÐ¼', 'Ð²Ð¸Ð¿', 'Ð¿ÐµÑ€ÑÐ¾Ð½Ð°Ð»ÑŒÐ½', 'Ð¾Ð±ÑÐ»ÑƒÐ¶Ð²Ð°Ð½', 'ÑƒÑÐ»ÑƒÐ³', 'ÐºÐ°Ð¿Ð¸Ñ‚Ð°Ð»', 'ÑƒÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½', 'Ñ…Ñ€Ð°Ð½ÐµÐ½'],
        'phrases': ['Ð¿Ñ€ÐµÐ¼Ð¸ÑƒÐ¼-Ð¾Ð±ÑÐ»ÑƒÐ¶Ð¸Ð²Ð°Ð½Ð¸Ðµ', 'VIP-ÑƒÑÐ»ÑƒÐ³Ð¸', 'ÑƒÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ ÐºÐ°Ð¿Ð¸Ñ‚Ð°Ð»Ð¾Ð¼', 'Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ðµ Ñ†ÐµÐ½Ð½Ð¾ÑÑ‚ÐµÐ¹']
    }
}

# Ð¤ÑƒÐ½ÐºÑ†Ð¸Ð¸ ÐºÐ»Ð°ÑÑÐ¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸Ð¸
def classify_sentiment(text):
    text = text.lower()
    sentiment_score = 0
    words = re.findall(r'\w+', text)
    for i, word in enumerate(words):
        base_score = 0
        for sentiment, keywords in SENTIMENT_LEXICON.items():
            for key, score in keywords.items():
                if key in word:
                    base_score = score
                    break
            if base_score != 0:
                break
        if base_score != 0:
            if i > 0 and words[i-1] in INTENSIFIERS:
                base_score *= INTENSIFIERS[words[i-1]]
            if i > 0 and words[i-1] in NEGATION_WORDS:
                base_score = -base_score
            sentiment_score += base_score
    return 'Ð¿Ð¾Ð»Ð¾Ð¶Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾' if sentiment_score > 1 else 'Ð¾Ñ‚Ñ€Ð¸Ñ†Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð¾' if sentiment_score < -1 else 'Ð½ÐµÐ¹Ñ‚Ñ€Ð°Ð»ÑŒÐ½Ð¾'

def classify_rating(sentiment):
    if sentiment == 'Ð¿Ð¾Ð»Ð¾Ð¶Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾':
        return random.randint(4, 5)
    elif sentiment == 'Ð½ÐµÐ¹Ñ‚Ñ€Ð°Ð»ÑŒÐ½Ð¾':
        return 3
    elif sentiment == 'Ð¾Ñ‚Ñ€Ð¸Ñ†Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð¾':
        return random.randint(1, 2)

def classify_topics(text):
    text = text.lower()
    categories = set()
    words = set(re.findall(r'\w+', text))
    for category, data in PRODUCT_CATEGORIES_TOPICS.items():
        keywords = set(data['keywords'])
        phrases = set(data['phrases'])
        if any(word in keywords for word in words) or any(phrase in text for phrase in phrases):
            categories.add(category)
    return list(categories)

def classify_product_category(text, topics):
    text = text.lower()
    categories = set()
    words = set(re.findall(r'\w+', text))
    for category, data in PRODUCT_CATEGORIES_MAIN.items():
        keywords = set(data['keywords'])
        phrases = set(data['phrases'])
        if any(word in keywords for word in words) or any(phrase in text for phrase in phrases):
            subcategories = []
            for subcat, subdata in data['subcategories'].items():
                sub_keywords = set(subdata['keywords'])
                sub_phrases = set(subdata['phrases'])
                if any(word in sub_keywords for word in words) or any(phrase in text for phrase in sub_phrases):
                    subcategories.append(subcat)
            if subcategories:
                for subcat in subcategories:
                    categories.add(f"{category} - {subcat}")
            else:
                categories.add(category)
    return list(categories) if categories else []

def process_review(review):
    text = review.get('text', '')
    id = review.get('id', 0)
    parts = re.split(r'\bÐ½Ð¾\b', text, flags=re.IGNORECASE)
    parts = [p.strip() for p in parts if p.strip()]
    
    topics = []
    sentiments = []
    if parts:
        for part in parts:
            part_topics = classify_topics(part)
            sentiment = classify_sentiment(part)
            for topic in part_topics:
                if topic not in topics:
                    topics.append(topic)
                    sentiments.append(sentiment)
    else:
        topics = classify_topics(text)
        sentiment = classify_sentiment(text)
        sentiments = [sentiment] * len(topics)
    
    product_categories = classify_product_category(text, topics)
    
    return {
        'id': id,
        'text': text,
        'topics': ', '.join(topics),
        'sentiments': ', '.join(sentiments),
        'product_category': ', '.join(product_categories) if product_categories else 'Ð”Ñ€ÑƒÐ³Ð¾Ðµ',
        'date': datetime.now().strftime('%d.%m.%Y'),
        'rating': sum(classify_rating(s) for s in sentiments) // len(sentiments) if sentiments else 3,
        'author': review.get('author', 'ÐšÐ»Ð¸ÐµÐ½Ñ‚ Ð±Ð°Ð½ÐºÐ°'),
        'source': 'gold'
    }

@st.cache_data
def load_data(uploaded_file):
    if uploaded_file is not None:
        data = json.load(uploaded_file)
        if 'data' in data and isinstance(data['data'], list):
            predictions = [process_review(review) for review in data['data']]
            df = pd.DataFrame(predictions)
            if not df.empty:
                df['date'] = pd.to_datetime(df['date'], format='%d.%m.%Y')
                st.info(f"Ð—Ð°Ð³Ñ€ÑƒÐ¶ÐµÐ½Ð¾ {len(df)} Ð¾Ñ‚Ð·Ñ‹Ð²Ð¾Ð²")
                return df
        st.error("ÐÐµÐ²ÐµÑ€Ð½Ñ‹Ð¹ Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚ JSON. ÐžÐ¶Ð¸Ð´Ð°ÐµÑ‚ÑÑ {'data': [{'id': 1, 'text': '...'}]}")
    return pd.DataFrame()

if uploaded_json:
    df = load_data(uploaded_json)
else:
    df = pd.DataFrame()
    st.sidebar.warning("Ð—Ð°Ð³Ñ€ÑƒÐ·Ð¸Ñ‚Ðµ JSON Ñ Ð¾Ñ‚Ð·Ñ‹Ð²Ð°Ð¼Ð¸ Ð´Ð»Ñ Ð°Ð½Ð°Ð»Ð¸Ð·Ð°")

if not df.empty and 'df' in locals():
    # Ð¤Ð¸Ð»ÑŒÑ‚Ñ€Ð°Ñ†Ð¸Ñ
    mask = (df['date'].dt.date >= start_date) & (df['date'].dt.date <= end_date) & (df['rating'].between(*rating_filter))
    if 'Ð’ÑÐµ' not in product_filter and product_filter:
        mask &= df['product_category'].str.contains('|'.join(product_filter), case=False, na=False)
    if subcat_filter:
        mask &= df['product_category'].str.contains('|'.join(subcat_filter), case=False, na=False)

    filtered_df = df[mask].copy()

    # Ð¢Ð°Ð±Ð»Ð¸Ñ†Ð° Ð¾Ñ‚Ð·Ñ‹Ð²Ð¾Ð²
    st.subheader("ðŸ“ ÐŸÐ¾Ð´Ñ€Ð¾Ð±Ð½Ñ‹Ðµ Ð¾Ñ‚Ð·Ñ‹Ð²Ñ‹")
    st.dataframe(filtered_df)

    # Ð“Ñ€Ð°Ñ„Ð¸Ðº Ñ€Ð°ÑÐ¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð¸Ñ Ñ‚Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾ÑÑ‚Ð¸
    st.subheader("ðŸ˜Š Ð Ð°ÑÐ¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð¸Ðµ Ñ‚Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾ÑÑ‚Ð¸")
    if 'sentiments' in filtered_df:
        sentiment_counts = filtered_df['sentiments'].str.split(', ').explode().value_counts()
        fig_sentiment = px.pie(names=sentiment_counts.index, values=sentiment_counts.values, title="Ð¢Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾ÑÑ‚ÑŒ Ð¾Ñ‚Ð·Ñ‹Ð²Ð¾Ð²",
                              color=sentiment_counts.index,
                              color_discrete_map={'Ð¿Ð¾Ð»Ð¾Ð¶Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾': '#90EE90', 'Ð¾Ñ‚Ñ€Ð¸Ñ†Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð¾': '#FF6347', 'Ð½ÐµÐ¹Ñ‚Ñ€Ð°Ð»ÑŒÐ½Ð¾': '#D3D3D3'})
        st.plotly_chart(fig_sentiment, use_container_width=True)
    else:
        st.write("ÐÐµÑ‚ Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð´Ð»Ñ Ð¾Ñ‚Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ñ Ñ‚Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾ÑÑ‚Ð¸.")

    # Ð Ð°ÑÐ¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð¸Ðµ Ð¿Ð¾ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸ÑÐ¼ Ð¿Ñ€Ð¾Ð´ÑƒÐºÑ‚Ð¾Ð²
    st.subheader("ðŸ“‹ Ð Ð°ÑÐ¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð¸Ðµ Ð¿Ð¾ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸ÑÐ¼ Ð¿Ñ€Ð¾Ð´ÑƒÐºÑ‚Ð¾Ð²")
    if 'product_category' in filtered_df:
        product_counts = filtered_df['product_category'].str.split(', ').explode().value_counts()
        fig_product = px.bar(x=product_counts.index, y=product_counts.values, title="ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸ Ð¿Ñ€Ð¾Ð´ÑƒÐºÑ‚Ð¾Ð²",
                             color=product_counts.index,
                             color_discrete_map={
                                 'ÐŸÐ¾Ð²ÑÐµÐ´Ð½ÐµÐ²Ð½Ñ‹Ðµ Ñ„Ð¸Ð½Ð°Ð½ÑÑ‹ Ð¸ Ð¿Ð»Ð°Ñ‚ÐµÐ¶Ð¸ - Ð’ÐµÐ´ÐµÐ½Ð¸Ðµ Ð²Ð°Ð»ÑŽÑ‚Ð½Ñ‹Ñ… ÑÑ‡ÐµÑ‚Ð¾Ð²': '#1f77b4',
                                 'ÐŸÐ¾Ð²ÑÐµÐ´Ð½ÐµÐ²Ð½Ñ‹Ðµ Ñ„Ð¸Ð½Ð°Ð½ÑÑ‹ Ð¸ Ð¿Ð»Ð°Ñ‚ÐµÐ¶Ð¸ - Ð”ÐµÐ±ÐµÑ‚Ð¾Ð²Ñ‹Ðµ ÐºÐ°Ñ€Ñ‚Ñ‹': '#1f77b4',
                                 'ÐŸÐ¾Ð²ÑÐµÐ´Ð½ÐµÐ²Ð½Ñ‹Ðµ Ñ„Ð¸Ð½Ð°Ð½ÑÑ‹ Ð¸ Ð¿Ð»Ð°Ñ‚ÐµÐ¶Ð¸ - ÐœÐ¾Ð±Ð¸Ð»ÑŒÐ½Ñ‹Ð¹ Ð±Ð°Ð½Ðº': '#1f77b4',
                                 'ÐŸÐ¾Ð²ÑÐµÐ´Ð½ÐµÐ²Ð½Ñ‹Ðµ Ñ„Ð¸Ð½Ð°Ð½ÑÑ‹ Ð¸ Ð¿Ð»Ð°Ñ‚ÐµÐ¶Ð¸ - ÐŸÐµÑ€ÐµÐ²Ð¾Ð´Ñ‹': '#1f77b4',
                                 'ÐŸÐ¾Ð²ÑÐµÐ´Ð½ÐµÐ²Ð½Ñ‹Ðµ Ñ„Ð¸Ð½Ð°Ð½ÑÑ‹ Ð¸ Ð¿Ð»Ð°Ñ‚ÐµÐ¶Ð¸ - Ð—Ð°Ñ€Ð¿Ð»Ð°Ñ‚Ð½Ñ‹Ðµ ÐºÐ°Ñ€Ñ‚Ñ‹': '#1f77b4',
                                 'Ð¡Ð±ÐµÑ€ÐµÐ¶ÐµÐ½Ð¸Ñ Ð¸ Ð½Ð°ÐºÐ¾Ð¿Ð»ÐµÐ½Ð¸Ñ - Ð¡Ñ€Ð¾Ñ‡Ð½Ñ‹Ðµ Ð²ÐºÐ»Ð°Ð´Ñ‹': '#ff7f0e',
                                 'Ð¡Ð±ÐµÑ€ÐµÐ¶ÐµÐ½Ð¸Ñ Ð¸ Ð½Ð°ÐºÐ¾Ð¿Ð»ÐµÐ½Ð¸Ñ - Ð¡Ð±ÐµÑ€ÐµÐ³Ð°Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ ÑÑ‡ÐµÑ‚Ð°': '#ff7f0e',
                                 'Ð¡Ð±ÐµÑ€ÐµÐ¶ÐµÐ½Ð¸Ñ Ð¸ Ð½Ð°ÐºÐ¾Ð¿Ð»ÐµÐ½Ð¸Ñ - ÐžÐ±ÐµÐ·Ð»Ð¸Ñ‡ÐµÐ½Ð½Ñ‹Ðµ Ð¼ÐµÑ‚Ð°Ð»Ð»Ð¸Ñ‡ÐµÑÐºÐ¸Ðµ ÑÑ‡ÐµÑ‚Ð°': '#ff7f0e',
                                 'Ð¡Ð±ÐµÑ€ÐµÐ¶ÐµÐ½Ð¸Ñ Ð¸ Ð½Ð°ÐºÐ¾Ð¿Ð»ÐµÐ½Ð¸Ñ - ÐÐ°ÐºÐ¾Ð¿Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ ÑÑ‡ÐµÑ‚Ð°': '#ff7f0e',
                                 'ÐšÑ€ÐµÐ´Ð¸Ñ‚Ð¾Ð²Ð°Ð½Ð¸Ðµ - ÐŸÐ¾Ñ‚Ñ€ÐµÐ±Ð¸Ñ‚ÐµÐ»ÑŒÑÐºÐ¸Ðµ ÐºÑ€ÐµÐ´Ð¸Ñ‚Ñ‹': '#2ca02c',
                                 'ÐšÑ€ÐµÐ´Ð¸Ñ‚Ð¾Ð²Ð°Ð½Ð¸Ðµ - ÐšÑ€ÐµÐ´Ð¸Ñ‚Ð½Ñ‹Ðµ ÐºÐ°Ñ€Ñ‚Ñ‹': '#2ca02c',
                                 'ÐšÑ€ÐµÐ´Ð¸Ñ‚Ð¾Ð²Ð°Ð½Ð¸Ðµ - Ð˜Ð¿Ð¾Ñ‚ÐµÑ‡Ð½Ñ‹Ðµ ÐºÑ€ÐµÐ´Ð¸Ñ‚Ñ‹': '#2ca02c',
                                 'ÐšÑ€ÐµÐ´Ð¸Ñ‚Ð¾Ð²Ð°Ð½Ð¸Ðµ - ÐÐ²Ñ‚Ð¾ÐºÑ€ÐµÐ´Ð¸Ñ‚Ñ‹': '#2ca02c',
                                 'ÐšÑ€ÐµÐ´Ð¸Ñ‚Ð¾Ð²Ð°Ð½Ð¸Ðµ - Ð ÐµÑ„Ð¸Ð½Ð°Ð½ÑÐ¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ': '#2ca02c',
                                 'Ð˜Ð½Ð²ÐµÑÑ‚Ð¸Ñ†Ð¸Ð¸ - Ð‘Ñ€Ð¾ÐºÐµÑ€ÑÐºÐ¸Ð¹ ÑÑ‡ÐµÑ‚': '#d62728',
                                 'Ð˜Ð½Ð²ÐµÑÑ‚Ð¸Ñ†Ð¸Ð¸ - Ð˜Ð˜Ð¡ (Ð˜Ð½Ð´Ð¸Ð²Ð¸Ð´ÑƒÐ°Ð»ÑŒÐ½Ñ‹Ð¹ Ð¸Ð½Ð²ÐµÑÑ‚Ð¸Ñ†Ð¸Ð¾Ð½Ð½Ñ‹Ð¹ ÑÑ‡ÐµÑ‚)': '#d62728',
                                 'Ð˜Ð½Ð²ÐµÑÑ‚Ð¸Ñ†Ð¸Ð¸ - ÐŸÐ˜Ð¤Ñ‹ (ÐŸÐ°ÐµÐ²Ñ‹Ðµ Ð¸Ð½Ð²ÐµÑÑ‚Ð¸Ñ†Ð¸Ð¾Ð½Ð½Ñ‹Ðµ Ñ„Ð¾Ð½Ð´Ñ‹)': '#d62728',
                                 'Ð˜Ð½Ð²ÐµÑÑ‚Ð¸Ñ†Ð¸Ð¸ - Ð¡Ñ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð½Ñ‹Ðµ Ð¿Ñ€Ð¾Ð´ÑƒÐºÑ‚Ñ‹': '#d62728',
                                 'Ð¡Ñ‚Ñ€Ð°Ñ…Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¸ Ð·Ð°Ñ‰Ð¸Ñ‚Ð° - Ð¡Ñ‚Ñ€Ð°Ñ…Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¿ÑƒÑ‚ÐµÑˆÐµÑÑ‚Ð²Ð¸Ð¹': '#9467bd',
                                 'Ð¡Ñ‚Ñ€Ð°Ñ…Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¸ Ð·Ð°Ñ‰Ð¸Ñ‚Ð° - Ð¡Ñ‚Ñ€Ð°Ñ…Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¸Ð¼ÑƒÑ‰ÐµÑÑ‚Ð²Ð°': '#9467bd',
                                 'Ð¡Ñ‚Ñ€Ð°Ñ…Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¸ Ð·Ð°Ñ‰Ð¸Ñ‚Ð° - Ð¡Ñ‚Ñ€Ð°Ñ…Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¾Ñ‚ Ð½ÐµÑÑ‡Ð°ÑÑ‚Ð½Ñ‹Ñ… ÑÐ»ÑƒÑ‡Ð°ÐµÐ² Ð¸ Ð±Ð¾Ð»ÐµÐ·Ð½ÐµÐ¹': '#9467bd',
                                 'Ð¡Ñ‚Ñ€Ð°Ñ…Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¸ Ð·Ð°Ñ‰Ð¸Ñ‚Ð° - Ð¡Ñ‚Ñ€Ð°Ñ…Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¿Ñ€Ð¸ Ð¾Ñ„Ð¾Ñ€Ð¼Ð»ÐµÐ½Ð¸Ð¸ ÐºÑ€ÐµÐ´Ð¸Ñ‚Ð¾Ð²': '#9467bd',
                                 'ÐŸÑ€ÐµÐ¼Ð¸Ð°Ð»ÑŒÐ½Ñ‹Ðµ ÑƒÑÐ»ÑƒÐ³Ð¸ - ÐŸÑ€Ð¸Ð²Ð°Ñ‚ Ð±Ð°Ð½ÐºÐ¸Ð½Ð³': '#8c564b',
                                 'ÐŸÑ€ÐµÐ¼Ð¸Ð°Ð»ÑŒÐ½Ñ‹Ðµ ÑƒÑÐ»ÑƒÐ³Ð¸ - Ð”ÐµÐ¿Ð¾Ð·Ð¸Ñ‚Ð°Ñ€Ð½Ñ‹Ðµ ÑÑ‡ÐµÐ¹ÐºÐ¸': '#8c564b',
                                 'ÐŸÑ€ÐµÐ¼Ð¸Ð°Ð»ÑŒÐ½Ñ‹Ðµ ÑƒÑÐ»ÑƒÐ³Ð¸ - Ð£ÑÐ»ÑƒÐ³Ð¸ Ð¿Ð¾ ÐºÐ¾Ð½ÑÑƒÐ»ÑŒÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸ÑŽ Ð¸ Ð¿Ð»Ð°Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸ÑŽ': '#8c564b',
                                 'Ð”Ñ€ÑƒÐ³Ð¾Ðµ': '#bcbd22'
                             })
        st.plotly_chart(fig_product, use_container_width=True)
    else:
        st.write("ÐÐµÑ‚ Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð´Ð»Ñ Ð¾Ñ‚Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ñ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¹.")
else:
    st.write("ÐÐµÑ‚ Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð´Ð»Ñ Ð°Ð½Ð°Ð»Ð¸Ð·Ð°. Ð—Ð°Ð³Ñ€ÑƒÐ·Ð¸Ñ‚Ðµ JSON Ñ Ð¾Ñ‚Ð·Ñ‹Ð²Ð°Ð¼Ð¸.")
