import streamlit as st
import pandas as pd
import plotly.express as px
import json
import re
from datetime import datetime, timedelta
import random

# ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸ ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ†Ñ‹
st.set_page_config(layout="wide", page_title="ÐÐ½Ð°Ð»Ð¸Ñ‚Ð¸ÐºÐ° Ð¾Ñ‚Ð·Ñ‹Ð²Ð¾Ð² Ð¾ Ð“Ð°Ð·Ð¿Ñ€Ð¾Ð¼Ð±Ð°Ð½ÐºÐµ")

# Ð—Ð°Ð³Ð¾Ð»Ð¾Ð²Ð¾Ðº
st.title("ÐÐ½Ð°Ð»Ð¸Ñ‚Ð¸ÐºÐ° Ð¾Ñ‚Ð·Ñ‹Ð²Ð¾Ð² Ð¾ Ð“Ð°Ð·Ð¿Ñ€Ð¾Ð¼Ð±Ð°Ð½ÐºÐµ")

# Ð¡Ð»Ð¾Ð²Ð°Ñ€ÑŒ Ð¿Ñ€Ð¾Ð´ÑƒÐºÑ‚Ð¾Ð² Ð¸ Ð¿Ð¾Ð´ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¹ (Ð¢ÐžÐ§ÐÐž ÐºÐ°Ðº Ð² Ð¢Ð—, Ñ ÐºÐ¾Ñ€Ñ€ÐµÐºÑ‚Ð¸Ñ€Ð¾Ð²ÐºÐ°Ð¼Ð¸ Ð´Ð»Ñ Ð¿Ñ€Ð¸Ð¼ÐµÑ€Ð°)
PRODUCT_CATEGORIES = {
    'ÐŸÐ¾Ð²ÑÐµÐ´Ð½ÐµÐ²Ð½Ñ‹Ðµ Ñ„Ð¸Ð½Ð°Ð½ÑÑ‹ Ð¸ Ð¿Ð»Ð°Ñ‚ÐµÐ¶Ð¸': [
        'Ð’ÐµÐ´ÐµÐ½Ð¸Ðµ Ð²Ð°Ð»ÑŽÑ‚Ð½Ñ‹Ñ… ÑÑ‡ÐµÑ‚Ð¾Ð²',
        'Ð”ÐµÐ±ÐµÑ‚Ð¾Ð²Ñ‹Ðµ ÐºÐ°Ñ€Ñ‚Ñ‹',
        'ÐœÐ¾Ð±Ð¸Ð»ÑŒÐ½Ð¾Ðµ Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ðµ',
        'ÐŸÐµÑ€ÐµÐ²Ð¾Ð´Ñ‹',
        'Ð—Ð°Ñ€Ð¿Ð»Ð°Ñ‚Ð½Ñ‹Ðµ ÐºÐ°Ñ€Ñ‚Ñ‹',
        'ÐžÐ±ÑÐ»ÑƒÐ¶Ð¸Ð²Ð°Ð½Ð¸Ðµ'
    ],
    'Ð¡Ð±ÐµÑ€ÐµÐ¶ÐµÐ½Ð¸Ñ Ð¸ Ð½Ð°ÐºÐ¾Ð¿Ð»ÐµÐ½Ð¸Ñ': [
        'Ð¡Ñ€Ð¾Ñ‡Ð½Ñ‹Ðµ Ð²ÐºÐ»Ð°Ð´Ñ‹',
        'Ð¡Ð±ÐµÑ€ÐµÐ³Ð°Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ ÑÑ‡ÐµÑ‚Ð°',
        'ÐžÐ±ÐµÐ·Ð»Ð¸Ñ‡ÐµÐ½Ð½Ñ‹Ðµ Ð¼ÐµÑ‚Ð°Ð»Ð»Ð¸Ñ‡ÐµÑÐºÐ¸Ðµ ÑÑ‡ÐµÑ‚Ð°',
        'ÐÐ°ÐºÐ¾Ð¿Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ ÑÑ‡ÐµÑ‚Ð°'
    ],
    'ÐšÑ€ÐµÐ´Ð¸Ñ‚Ð¾Ð²Ð°Ð½Ð¸Ðµ': [
        'ÐŸÐ¾Ñ‚Ñ€ÐµÐ±Ð¸Ñ‚ÐµÐ»ÑŒÑÐºÐ¸Ðµ ÐºÑ€ÐµÐ´Ð¸Ñ‚Ñ‹',
        'ÐšÑ€ÐµÐ´Ð¸Ñ‚Ð½Ð°Ñ ÐºÐ°Ñ€Ñ‚Ð°',
        'Ð˜Ð¿Ð¾Ñ‚ÐµÑ‡Ð½Ñ‹Ðµ ÐºÑ€ÐµÐ´Ð¸Ñ‚Ñ‹',
        'ÐÐ²Ñ‚Ð¾ÐºÑ€ÐµÐ´Ð¸Ñ‚Ñ‹',
        'Ð ÐµÑ„Ð¸Ð½Ð°Ð½ÑÐ¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ'
    ],
    'Ð˜Ð½Ð²ÐµÑÑ‚Ð¸Ñ†Ð¸Ð¸': [
        'Ð‘Ñ€Ð¾ÐºÐµÑ€ÑÐºÐ¸Ð¹ ÑÑ‡ÐµÑ‚',
        'Ð˜Ð˜Ð¡ (Ð˜Ð½Ð´Ð¸Ð²Ð¸Ð´ÑƒÐ°Ð»ÑŒÐ½Ñ‹Ð¹ Ð¸Ð½Ð²ÐµÑÑ‚Ð¸Ñ†Ð¸Ð¾Ð½Ð½Ñ‹Ð¹ ÑÑ‡ÐµÑ‚)',
        'ÐŸÐ˜Ð¤Ñ‹ (ÐŸÐ°ÐµÐ²Ñ‹Ðµ Ð¸Ð½Ð²ÐµÑÑ‚Ð¸Ñ†Ð¸Ð¾Ð½Ð½Ñ‹Ðµ Ñ„Ð¾Ð½Ð´Ñ‹)',
        'Ð¡Ñ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð½Ñ‹Ðµ Ð¿Ñ€Ð¾Ð´ÑƒÐºÑ‚Ñ‹'
    ],
    'Ð¡Ñ‚Ñ€Ð°Ñ…Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¸ Ð·Ð°Ñ‰Ð¸Ñ‚Ð°': [
        'Ð¡Ñ‚Ñ€Ð°Ñ…Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¿ÑƒÑ‚ÐµÑˆÐµÑÑ‚Ð²Ð¸Ð¹',
        'Ð¡Ñ‚Ñ€Ð°Ñ…Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¸Ð¼ÑƒÑ‰ÐµÑÑ‚Ð²Ð°',
        'Ð¡Ñ‚Ñ€Ð°Ñ…Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¾Ñ‚ Ð½ÐµÑÑ‡Ð°ÑÑ‚Ð½Ñ‹Ñ… ÑÐ»ÑƒÑ‡Ð°ÐµÐ² Ð¸ Ð±Ð¾Ð»ÐµÐ·Ð½ÐµÐ¹',
        'Ð¡Ñ‚Ñ€Ð°Ñ…Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¿Ñ€Ð¸ Ð¾Ñ„Ð¾Ñ€Ð¼Ð»ÐµÐ½Ð¸Ð¸ ÐºÑ€ÐµÐ´Ð¸Ñ‚Ð¾Ð²'
    ],
    'ÐŸÑ€ÐµÐ¼Ð¸Ð°Ð»ÑŒÐ½Ñ‹Ðµ ÑƒÑÐ»ÑƒÐ³Ð¸': [
        'ÐŸÑ€Ð¸Ð²Ð°Ñ‚ Ð±Ð°Ð½ÐºÐ¸Ð½Ð³',
        'Ð”ÐµÐ¿Ð¾Ð·Ð¸Ñ‚Ð°Ñ€Ð½Ñ‹Ðµ ÑÑ‡ÐµÐ¹ÐºÐ¸',
        'Ð£ÑÐ»ÑƒÐ³Ð¸ Ð¿Ð¾ ÐºÐ¾Ð½ÑÑƒÐ»ÑŒÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸ÑŽ Ð¸ Ð¿Ð»Ð°Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸ÑŽ'
    ]
}

# ÐžÐ±Ñ€Ð°Ñ‚Ð½Ð¾Ðµ ÑÐ¾Ð¿Ð¾ÑÑ‚Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ð¿Ð¾Ð´ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¹ Ðº ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸ÑÐ¼
SUBCAT_TO_CAT = {sub: cat for cat, subs in PRODUCT_CATEGORIES.items() for sub in subs}

# Ð¡Ð¾Ð±Ð¸Ñ€Ð°ÐµÐ¼ Ð²ÑÐµ Ð¿Ð¾Ð´ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸ Ð¸ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸
ALL_CATEGORIES = list(PRODUCT_CATEGORIES.keys())
ALL_SUBCATEGORIES = [sub for subs in PRODUCT_CATEGORIES.values() for sub in subs]

# Ð¡Ð»Ð¾Ð²Ð°Ñ€ÑŒ ÐºÐ»ÑŽÑ‡ÐµÐ²Ñ‹Ñ… ÑÐ»Ð¾Ð² Ð¸ Ñ„Ñ€Ð°Ð· (Ñ€Ð°ÑÑˆÐ¸Ñ€ÐµÐ½Ð½Ñ‹Ð¹ Ð¿Ñ€ÐµÐ´Ð¾ÑÑ‚Ð°Ð²Ð»ÐµÐ½Ð½Ñ‹Ð¼Ð¸ Ð´Ð°Ð½Ð½Ñ‹Ð¼Ð¸ + Ð´Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ð¾Ñ‚ Ð¼ÐµÐ½Ñ)
KEYWORDS = {
    'ÐŸÐ¾Ð²ÑÐµÐ´Ð½ÐµÐ²Ð½Ñ‹Ðµ Ñ„Ð¸Ð½Ð°Ð½ÑÑ‹ Ð¸ Ð¿Ð»Ð°Ñ‚ÐµÐ¶Ð¸': {
        'keywords': [
            'Ð´ÐµÐ±ÐµÑ‚', 'ÐºÐ°Ñ€Ñ‚', 'ÑÑ‡ÐµÑ‚', 'Ð¿ÐµÑ€ÐµÐ²Ð¾Ð´', 'Ð·Ð°Ñ€Ð¿Ð»Ð°Ñ‚', 
            'Ð¼Ð¾Ð±Ð¸Ð»ÑŒ', 'Ð±Ð°Ð½Ðº', 'Ð¿Ð»Ð°Ñ‚ÐµÐ¶', 'Ð²Ð°Ð»ÑŽÑ‚', 'Ñ€ÑƒÐ±Ð»', 'Ð´Ð¾Ð»Ð»Ð°Ñ€', 
            'ÐµÐ²Ñ€Ð¾', 'ÑÐ½ÑÑ‚', 'Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½', 'Ð±Ð°Ð½ÐºÐ¾Ð¼Ð°Ñ‚', 'Ð¾Ð¿Ð»Ð°Ñ‚', 'ÐºÐ²Ð¸Ñ‚Ð°Ð½Ñ†',
            'ÐºÐ¾Ð¼Ð¸ÑÑ', 'Ð¾Ð±ÑÐ»ÑƒÐ¶Ð²Ð°Ð½', 'Ð¾Ñ‚Ð´ÐµÐ»ÐµÐ½Ð¸', 'ÐºÐ»Ð¸ÐµÐ½Ñ‚', 'Ð¾Ñ‡ÐµÑ€ÐµÐ´',
            'Ð¾Ð½Ð»Ð°Ð¹Ð½', 'Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½', 'Ð¸Ð½Ñ‚ÐµÑ€Ð½ÐµÑ‚', 'ÑÐ¼Ñ', 'ÑƒÐ²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½',
            'ÑÑ€ÐµÐ´ÑÑ‚Ð²', 'Ð´ÐµÐ½ÑŒÐ³', 'Ð½Ð°Ð»Ð¸Ñ‡', 'Ð±ÐµÐ·Ð½Ð°Ð»', 'ÑÐ±ÐµÑ€ÐºÐ½Ð¸Ð¶Ðº',
            'Ð²Ñ‹Ð¿Ð¸Ñ', 'Ð±Ð°Ð»Ð°Ð½Ñ', 'Ð¾ÑÑ‚Ð°Ñ‚Ð¾Ðº',
            # Ð”Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ð¾Ñ‚ Ð¼ÐµÐ½Ñ
            'Ð¿Ð¾Ð¿Ð¾Ð»Ð½ÐµÐ½', 'Ñ‚ÐµÑ€Ð¼Ð¸Ð½Ð°Ð»', 'ÐºÐ°ÑÑ', 'Ñ‡ÐµÐº', 'Ñ€ÐµÐºÐ²Ð¸Ð·Ð¸Ñ‚', 
            'ÑÐ²Ð¸Ñ„Ñ‚', 'iban', 'bic', 'qr-ÐºÐ¾Ð´', 'nfc', 'ÐºÐ¾Ð½Ñ‚Ð°ÐºÑ‚Ð»ÐµÑÑ',
            'ÑÐ¿Ð»Ð¿ÑÐ¹', 'Ð³ÑƒÐ³Ð»Ð¿ÑÐ¹', 'ÑÐ°Ð¼ÑÑƒÐ½Ð³Ð¿ÑÐ¹', 'Ð¼Ð¸Ñ€Ð¿ÑÐ¹', 'Ñ‚Ñ€Ð°Ð½Ð·Ð°ÐºÑ†'
        ],
        'phrases': [
            'Ð´ÐµÐ±ÐµÑ‚Ð¾Ð²Ð°Ñ ÐºÐ°Ñ€Ñ‚Ð°', 'Ð·Ð°Ñ€Ð¿Ð»Ð°Ñ‚Ð½Ð°Ñ ÐºÐ°Ñ€Ñ‚Ð°', 'Ð¼Ð¾Ð±Ð¸Ð»ÑŒÐ½Ñ‹Ð¹ Ð±Ð°Ð½Ðº', 
            'Ð¿ÐµÑ€ÐµÐ²Ð¾Ð´ Ð´ÐµÐ½ÐµÐ³', 'Ð¾Ñ‚ÐºÑ€Ñ‹Ñ‚ÑŒ ÑÑ‡ÐµÑ‚', 'Ð²Ð°Ð»ÑŽÑ‚Ð½Ñ‹Ð¹ ÑÑ‡ÐµÑ‚',
            'Ð±Ð°Ð½ÐºÐ¾Ð²ÑÐºÐ¸Ð¹ ÑÑ‡ÐµÑ‚', 'Ñ€Ð°ÑÑ‡ÐµÑ‚Ð½Ñ‹Ð¹ ÑÑ‡ÐµÑ‚', 'ÑÐ½ÑÑ‚ÑŒ Ð´ÐµÐ½ÑŒÐ³Ð¸',
            'Ð¿Ð¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ Ð´ÐµÐ½ÑŒÐ³Ð¸', 'Ð¾Ð¿Ð»Ð°Ñ‚Ð¸Ñ‚ÑŒ ÑƒÑÐ»ÑƒÐ³Ð¸', 'ÐºÐ¾Ð¼Ð¸ÑÑÐ¸Ñ Ð·Ð° Ð¿ÐµÑ€ÐµÐ²Ð¾Ð´',
            'Ð¾Ð±ÑÐ»ÑƒÐ¶Ð¸Ð²Ð°Ð½Ð¸Ðµ ÐºÐ°Ñ€Ñ‚Ñ‹', 'Ð¾Ñ‚Ð´ÐµÐ»ÐµÐ½Ð¸Ðµ Ð±Ð°Ð½ÐºÐ°', 'Ð¾Ñ‡ÐµÑ€ÐµÐ´ÑŒ Ð² Ð±Ð°Ð½ÐºÐµ',
            'Ð¸Ð½Ñ‚ÐµÑ€Ð½ÐµÑ‚ Ð±Ð°Ð½Ðº', 'Ð¼Ð¾Ð±Ð¸Ð»ÑŒÐ½Ð¾Ðµ Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ðµ', 'ÑÐ¼Ñ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ',
            'Ð±ÐµÐ·Ð½Ð°Ð»Ð¸Ñ‡Ð½Ñ‹Ð¹ Ñ€Ð°ÑÑ‡ÐµÑ‚', 'Ð²Ñ‹Ð¿Ð¸ÑÐºÐ° Ð¿Ð¾ ÑÑ‡ÐµÑ‚Ñƒ', 'Ð¾ÑÑ‚Ð°Ñ‚Ð¾Ðº Ð½Ð° ÑÑ‡ÐµÑ‚Ðµ',
            # Ð”Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ð¾Ñ‚ Ð¼ÐµÐ½Ñ
            'Ð¿Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÑŒ ÐºÐ°Ñ€Ñ‚Ñƒ', 'Ð¿Ð»Ð°Ñ‚ÐµÐ¶Ð½Ñ‹Ð¹ Ñ‚ÐµÑ€Ð¼Ð¸Ð½Ð°Ð»', 'Ñ‡ÐµÐº Ð¾Ð± Ð¾Ð¿Ð»Ð°Ñ‚Ðµ',
            'Ð±Ð°Ð½ÐºÐ¾Ð²ÑÐºÐ¸Ðµ Ñ€ÐµÐºÐ²Ð¸Ð·Ð¸Ñ‚Ñ‹', 'Ð¼ÐµÐ¶Ð´ÑƒÐ½Ð°Ñ€Ð¾Ð´Ð½Ñ‹Ð¹ Ð¿ÐµÑ€ÐµÐ²Ð¾Ð´', 'Ð±ÐµÑÐºÐ¾Ð½Ñ‚Ð°ÐºÑ‚Ð½Ð°Ñ Ð¾Ð¿Ð»Ð°Ñ‚Ð°',
            'apple pay', 'google pay', 'samsung pay', 'mir pay', 'qr-Ð¾Ð¿Ð»Ð°Ñ‚Ð°'
        ]
    },
    'Ð¡Ð±ÐµÑ€ÐµÐ¶ÐµÐ½Ð¸Ñ Ð¸ Ð½Ð°ÐºÐ¾Ð¿Ð»ÐµÐ½Ð¸Ñ': {
        'keywords': [
            'Ð²ÐºÐ»Ð°Ð´', 'ÑÐ±ÐµÑ€ÐµÐ³Ð°Ñ‚ÐµÐ»ÑŒÐ½', 'Ð½Ð°ÐºÐ¾Ð¿Ð¸Ñ‚', 'ÑÐ±ÐµÑ€ÐµÐ¶ÐµÐ½', 'Ð¼ÐµÑ‚Ð°Ð»Ð»', 
            'ÑÑ‡ÐµÑ‚', 'ÑÑ€Ð¾Ñ‡Ð½', 'Ð¿Ñ€Ð¾Ñ†ÐµÐ½Ñ‚', 'Ð½Ð°ÐºÐ¾Ð¿', 'ÑÐ±ÐµÑ€ÐµÐ³', 'Ð´ÐµÐ¿Ð¾Ð·Ð¸Ñ‚',
            'ÑÑ‚Ð°Ð²Ðº', 'Ð´Ð¾Ñ…Ð¾Ð´Ð½Ð¾ÑÑ‚', 'ÐºÐ°Ð¿Ð¸Ñ‚Ð°Ð»Ð¸Ð·Ð°Ñ†', 'Ð¿Ð¾Ð¿Ð¾Ð»Ð½ÐµÐ½', 'ÑÐ½ÑÑ‚',
            'Ð¿Ñ€Ð¾Ð»Ð¾Ð½Ð³Ð°Ñ†', 'Ð¿Ñ€Ð¾Ñ†ÐµÐ½Ñ‚Ñ‹', 'Ð½Ð°Ñ‡Ð¸ÑÐ»ÐµÐ½', 'Ð·Ð°Ð±Ñ€Ð°Ñ‚', 'Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½',
            'Ð·Ð¾Ð»Ð¾Ñ‚', 'ÑÐµÑ€ÐµÐ±Ñ€', 'Ð¿Ð»Ð°Ñ‚Ð¸Ð½', 'Ð¿Ð°Ð»Ð»Ð°Ð´', 'ÑÐ»Ð¸Ñ‚Ðº',
            'ÑÐ±ÐµÑ€ÐµÐ³Ð°Ñ‚ÐµÐ»ÑŒÐ½', 'ÑÐµÑ€Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ‚', 'Ð½Ð°ÐºÐ¾Ð¿Ð»ÐµÐ½', 'Ð¾Ñ‚ÐºÑ€Ñ‹Ñ‚', 'Ð·Ð°ÐºÑ€Ñ‹Ñ‚',
            # Ð”Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ð¾Ñ‚ Ð¼ÐµÐ½Ñ
            'Ð°ÐºÐºÑƒÐ¼ÑƒÐ»ÑÑ†', 'Ñ€ÐµÐ·ÐµÑ€Ð²', 'ÐºÐ¾Ð¿Ð¸Ð»Ðº', 'Ð¿ÐµÐ½ÑÐ¸Ð¾Ð½', 'Ð´ÐµÑ‚ÑÐº', 
            'Ð½Ð°ÑÐ»ÐµÐ´', 'Ñ†ÐµÐ»ÐµÐ²Ð¾', 'ÐµÐ¶ÐµÐ¼ÐµÑÑÑ‡Ð½', 'ÐºÐ²Ð°Ñ€Ñ‚Ð°Ð»ÑŒÐ½', 'Ð³Ð¾Ð´Ð¾Ð²'
        ],
        'phrases': [
            'ÑÑ€Ð¾Ñ‡Ð½Ñ‹Ð¹ Ð²ÐºÐ»Ð°Ð´', 'ÑÐ±ÐµÑ€ÐµÐ³Ð°Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ð¹ ÑÑ‡ÐµÑ‚', 'Ð¼ÐµÑ‚Ð°Ð»Ð»Ð¸Ñ‡ÐµÑÐºÐ¸Ð¹ ÑÑ‡ÐµÑ‚',
            'Ð¾Ñ‚ÐºÑ€Ñ‹Ñ‚ÑŒ Ð²ÐºÐ»Ð°Ð´', 'Ð½Ð°ÐºÐ¾Ð¿Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ð¹ ÑÑ‡ÐµÑ‚', 'Ð¾Ð±ÐµÐ·Ð»Ð¸Ñ‡ÐµÐ½Ð½Ñ‹Ð¹ Ð¼ÐµÑ‚Ð°Ð»Ð»Ð¸Ñ‡ÐµÑÐºÐ¸Ð¹',
            'Ð±Ð°Ð½ÐºÐ¾Ð²ÑÐºÐ¸Ð¹ Ð²ÐºÐ»Ð°Ð´', 'Ð´ÐµÐ¿Ð¾Ð·Ð¸Ñ‚Ð½Ñ‹Ð¹ ÑÑ‡ÐµÑ‚', 'Ð¿Ñ€Ð¾Ñ†ÐµÐ½Ñ‚Ð½Ð°Ñ ÑÑ‚Ð°Ð²ÐºÐ°',
            'Ð´Ð¾Ñ…Ð¾Ð´ Ð¿Ð¾ Ð²ÐºÐ»Ð°Ð´Ñƒ', 'ÐºÐ°Ð¿Ð¸Ñ‚Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ Ð¿Ñ€Ð¾Ñ†ÐµÐ½Ñ‚Ð¾Ð²', 'Ð¿Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÑŒ Ð²ÐºÐ»Ð°Ð´',
            'ÑÐ½ÑÑ‚ÑŒ ÑÐ¾ Ð²ÐºÐ»Ð°Ð´Ð°', 'Ð¿Ñ€Ð¾Ð»Ð¾Ð½Ð³Ð°Ñ†Ð¸Ñ Ð²ÐºÐ»Ð°Ð´Ð°', 'Ð½Ð°Ñ‡Ð¸ÑÐ»ÐµÐ½Ð¸Ðµ Ð¿Ñ€Ð¾Ñ†ÐµÐ½Ñ‚Ð¾Ð²',
            'Ð·Ð°Ð±Ñ€Ð°Ñ‚ÑŒ Ð²ÐºÐ»Ð°Ð´', 'Ð¾Ñ‚ÐºÑ€Ñ‹Ñ‚ÑŒ Ð´ÐµÐ¿Ð¾Ð·Ð¸Ñ‚', 'Ð·Ð¾Ð»Ð¾Ñ‚Ð¾Ð¹ ÑÐ»Ð¸Ñ‚Ð¾Ðº',
            'ÑÐ±ÐµÑ€ÐµÐ³Ð°Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ð¹ ÑÐµÑ€Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ‚', 'Ð½Ð°ÐºÐ¾Ð¿Ð¸Ñ‚ÑŒ Ð´ÐµÐ½ÑŒÐ³Ð¸',
            # Ð”Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ð¾Ñ‚ Ð¼ÐµÐ½Ñ
            'Ñ„Ð¸Ð½Ð°Ð½ÑÐ¾Ð²Ð°Ñ Ð¿Ð¾Ð´ÑƒÑˆÐºÐ°', 'Ð¿ÐµÐ½ÑÐ¸Ð¾Ð½Ð½Ñ‹Ðµ Ð½Ð°ÐºÐ¾Ð¿Ð»ÐµÐ½Ð¸Ñ', 'Ð´ÐµÑ‚ÑÐºÐ¸Ð¹ Ð²ÐºÐ»Ð°Ð´',
            'Ñ†ÐµÐ»ÐµÐ²Ð¾Ð¹ Ð´ÐµÐ¿Ð¾Ð·Ð¸Ñ‚', 'ÐµÐ¶ÐµÐ¼ÐµÑÑÑ‡Ð½Ñ‹Ðµ Ð½Ð°Ñ‡Ð¸ÑÐ»ÐµÐ½Ð¸Ñ', 'Ð³Ð¾Ð´Ð¾Ð²Ð¾Ð¹ Ð¿Ñ€Ð¾Ñ†ÐµÐ½Ñ‚'
        ]
    },
    'ÐšÑ€ÐµÐ´Ð¸Ñ‚Ð¾Ð²Ð°Ð½Ð¸Ðµ': {
        'keywords': [
            'ÐºÑ€ÐµÐ´Ð¸Ñ‚', 'Ð¸Ð¿Ð¾Ñ‚ÐµÐº', 'Ð°Ð²Ñ‚Ð¾ÐºÑ€ÐµÐ´Ð¸Ñ‚', 'Ñ€ÐµÑ„Ð¸Ð½Ð°Ð½ÑÐ¸Ñ€Ð¾Ð²Ð°Ð½', 'Ð·Ð°ÐµÐ¼', 
            'Ð¿Ð»Ð°Ñ‚ÐµÐ¶', 'Ð¿Ñ€Ð¾Ñ†ÐµÐ½Ñ‚', 'ÑÑ‚Ð°Ð²Ðº', 'Ð¾Ð´Ð¾Ð±Ñ€ÐµÐ½', 'Ð¿Ð¾Ð³Ð°ÑˆÐµÐ½', 'Ð²Ð·ÑÑ‚',
            'Ð¾Ñ„Ð¾Ñ€Ð¼Ð»ÐµÐ½', 'Ð´Ð¾Ð»Ð³', 'Ð·Ð°Ð´Ð¾Ð»Ð¶ÐµÐ½Ð½Ð¾ÑÑ‚', 'Ð¿Ñ€Ð¾ÑÑ€Ð¾Ñ‡Ðº', 'ÑˆÑ‚Ñ€Ð°Ñ„',
            'Ð¿ÐµÐ½Ð¸', 'Ñ€ÐµÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð¸Ð·Ð°Ñ†', 'Ñ€ÐµÑˆÐµÐ½', 'Ð¾Ñ‚ÐºÐ°Ð·', 'ÑƒÑÐ»Ð¾Ð²',
            'Ñ‚Ñ€ÐµÐ±Ð¾Ð²Ð°Ð½', 'ÑÐ¿Ñ€Ð°Ð²Ðº', 'Ð·Ð°ÑÐ²Ðº', 'Ð°Ð½ÐºÐµÑ‚', 'ÐºÑ€ÐµÐ´Ð¸Ñ‚Ð½', 'Ð¸ÑÑ‚Ð¾Ñ€Ð¸',
            'ÑÐºÐ¾Ñ€Ð¸Ð½Ð³', 'Ð»Ð¸Ð¼Ð¸Ñ‚', 'Ð»ÑŒÐ³Ð¾Ñ‚Ð½', 'Ð¿ÐµÑ€Ð¸Ð¾Ð´', 'Ð³Ñ€Ð°Ñ„Ð¸Ðº', 'Ð¿Ð»Ð°Ñ‚ÐµÐ¶',
            # Ð”Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ð¾Ñ‚ Ð¼ÐµÐ½Ñ
            'Ð¾Ð²ÐµÑ€Ð´Ñ€Ð°Ñ„Ñ‚', 'Ð»Ð¸Ð·Ð¸Ð½Ð³', 'Ñ„Ð°ÐºÑ‚Ð¾Ñ€Ð¸Ð½Ð³', 'Ð³Ð°Ñ€Ð°Ð½Ñ‚', 'Ð¿Ð¾Ñ€ÑƒÑ‡Ð¸Ñ‚ÐµÐ»', 
            'Ð·Ð°Ð»Ð¾Ð³', 'Ð¸Ð¿Ð¾Ñ‚ÐµÑ‡Ð½', 'Ð°Ð²Ñ‚Ð¾', 'Ð¿Ð¾Ñ‚Ñ€ÐµÐ±Ð¸Ñ‚ÐµÐ»', 'Ð¼Ð¸ÐºÑ€Ð¾Ð·Ð°Ð¹Ð¼'
        ],
        'phrases': [
            'Ð¿Ð¾Ñ‚Ñ€ÐµÐ±Ð¸Ñ‚ÐµÐ»ÑŒÑÐºÐ¸Ð¹ ÐºÑ€ÐµÐ´Ð¸Ñ‚', 'Ð¸Ð¿Ð¾Ñ‚ÐµÑ‡Ð½Ñ‹Ð¹ ÐºÑ€ÐµÐ´Ð¸Ñ‚', 'Ð²Ð·ÑÑ‚ÑŒ ÐºÑ€ÐµÐ´Ð¸Ñ‚',
            'Ð¾Ñ„Ð¾Ñ€Ð¼Ð¸Ñ‚ÑŒ ÐºÑ€ÐµÐ´Ð¸Ñ‚', 'ÐºÑ€ÐµÐ´Ð¸Ñ‚Ð½Ð°Ñ ÐºÐ°Ñ€Ñ‚Ð°', 'Ñ€ÐµÑ„Ð¸Ð½Ð°Ð½ÑÐ¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ ÐºÑ€ÐµÐ´Ð¸Ñ‚Ð°',
            'Ð°Ð²Ñ‚Ð¾Ð¼Ð¾Ð±Ð¸Ð»ÑŒÐ½Ñ‹Ð¹ ÐºÑ€ÐµÐ´Ð¸Ñ‚', 'Ð¾Ð´Ð¾Ð±Ñ€ÐµÐ½Ð¸Ðµ ÐºÑ€ÐµÐ´Ð¸Ñ‚Ð°', 'Ð¿Ð¾Ð³Ð°ÑˆÐµÐ½Ð¸Ðµ ÐºÑ€ÐµÐ´Ð¸Ñ‚Ð°',
            'ÐºÑ€ÐµÐ´Ð¸Ñ‚Ð½Ð°Ñ Ð¸ÑÑ‚Ð¾Ñ€Ð¸Ñ', 'Ð¿Ñ€Ð¾Ñ†ÐµÐ½Ñ‚Ð½Ð°Ñ ÑÑ‚Ð°Ð²ÐºÐ°', 'ÐµÐ¶ÐµÐ¼ÐµÑÑÑ‡Ð½Ñ‹Ð¹ Ð¿Ð»Ð°Ñ‚ÐµÐ¶',
            'Ð»ÑŒÐ³Ð¾Ñ‚Ð½Ñ‹Ð¹ Ð¿ÐµÑ€Ð¸Ð¾Ð´', 'Ð³Ñ€Ð°Ñ„Ð¸Ðº Ð¿Ð»Ð°Ñ‚ÐµÐ¶ÐµÐ¹', 'Ð¿Ñ€Ð¾ÑÑ€Ð¾Ñ‡ÐºÐ° Ð¿Ð»Ð°Ñ‚ÐµÐ¶Ð°',
            'ÑˆÑ‚Ñ€Ð°Ñ„Ð½Ñ‹Ðµ ÑÐ°Ð½ÐºÑ†Ð¸Ð¸', 'Ñ€ÐµÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð¸Ð·Ð°Ñ†Ð¸Ñ Ð´Ð¾Ð»Ð³Ð°', 'Ð¾Ñ‚ÐºÐ°Ð· Ð² ÐºÑ€ÐµÐ´Ð¸Ñ‚Ðµ',
            'ÐºÑ€ÐµÐ´Ð¸Ñ‚Ð½Ð°Ñ Ð·Ð°ÑÐ²ÐºÐ°', 'ÑÐ¿Ñ€Ð°Ð²ÐºÐ° Ð¾ Ð´Ð¾Ñ…Ð¾Ð´Ð°Ñ…', 'ÐºÑ€ÐµÐ´Ð¸Ñ‚Ð½Ñ‹Ð¹ Ð»Ð¸Ð¼Ð¸Ñ‚',
            # Ð”Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ð¾Ñ‚ Ð¼ÐµÐ½Ñ
            'Ð¾Ð²ÐµÑ€Ð´Ñ€Ð°Ñ„Ñ‚ Ð¿Ð¾ ÐºÐ°Ñ€Ñ‚Ðµ', 'Ð»Ð¸Ð·Ð¸Ð½Ð³ Ð°Ð²Ñ‚Ð¾Ð¼Ð¾Ð±Ð¸Ð»Ñ', 'Ð±Ð°Ð½ÐºÐ¾Ð²ÑÐºÐ°Ñ Ð³Ð°Ñ€Ð°Ð½Ñ‚Ð¸Ñ',
            'Ð·Ð°Ð»Ð¾Ð³ Ð¸Ð¼ÑƒÑ‰ÐµÑÑ‚Ð²Ð°', 'Ð¼Ð¸ÐºÑ€Ð¾Ð·Ð°Ð¹Ð¼ Ð¾Ð½Ð»Ð°Ð¹Ð½', 'ÐºÑ€ÐµÐ´Ð¸Ñ‚ Ð¿Ð¾Ð´ Ð·Ð°Ð»Ð¾Ð³'
        ]
    },
    'Ð˜Ð½Ð²ÐµÑÑ‚Ð¸Ñ†Ð¸Ð¸': {
        'keywords': [
            'Ð¸Ð½Ð²ÐµÑÑ‚', 'Ð±Ñ€Ð¾ÐºÐµÑ€', 'Ð¸Ð¸Ñ', 'Ð¿Ð¸Ñ„', 'Ð°ÐºÑ†Ð¸', 'Ð¾Ð±Ð»Ð¸Ð³Ð°Ñ†', 
            'Ð±Ð¸Ñ€Ð¶', 'Ð¿Ð¾Ñ€Ñ‚Ñ„ÐµÐ»ÑŒ', 'Ð´Ð¾Ñ…Ð¾Ð´Ð½Ð¾ÑÑ‚', 'ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð½', 'Ð¿Ð°Ð¹',
            'Ñ„Ð¾Ð½Ð´', 'Ñ†ÐµÐ½Ð½', 'Ð±ÑƒÐ¼Ð°Ð³', 'Ñ‚Ð¾Ñ€Ð³Ð¾Ð²', 'ÑÐ´ÐµÐ»Ðº', 'ÐºÑƒÐ¿Ð»Ñ',
            'Ð¿Ñ€Ð¾Ð´Ð°Ð¶', 'ÐºÐ¾Ñ‚Ð¸Ñ€Ð¾Ð²Ðº', 'Ð´Ð¸Ð²Ð¸Ð´ÐµÐ½Ð´', 'ÐºÑƒÐ¿Ð¾Ð½', 'Ð²Ñ‹Ð¿Ð»Ð°Ñ‚',
            'Ñ€Ð¸ÑÐº', 'Ð¿Ñ€Ð¸Ð±Ñ‹Ð»', 'ÑƒÐ±Ñ‹Ñ‚Ð¾Ðº', 'Ð°Ð½Ð°Ð»Ð¸Ð·', 'ÑÐ¾Ð²ÐµÑ‚', 'ÑƒÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½',
            'Ð¸Ð½Ð²ÐµÑÑ‚Ð¾Ñ€', 'Ñ‚Ñ€ÐµÐ¹Ð´ÐµÑ€', 'Ð»Ð¸Ñ†ÐµÐ½Ð·', 'ÐºÐ¾Ð¼Ð¸ÑÑ', 'Ñ‚Ð°Ñ€Ð¸Ñ„',
            # Ð”Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ð¾Ñ‚ Ð¼ÐµÐ½Ñ
            'Ñ„ÑŒÑŽÑ‡ÐµÑ€Ñ', 'Ð¾Ð¿Ñ†Ð¸Ð¾Ð½', 'ÑÐ²Ð¾Ð¿', 'Ñ…ÐµÐ´Ð¶', 'Ð´Ð¸Ð²ÐµÑ€ÑÐ¸Ñ„Ð¸ÐºÐ°Ñ†', 
            'Ð²Ð¾Ð»Ð°Ñ‚Ð¸Ð»ÑŒÐ½Ð¾ÑÑ‚', 'Ð¼Ð°Ñ€Ð¶', 'Ð»ÐµÐ²ÐµÑ€Ð¸Ð´Ð¶', 'ipo', 'ÑÐ¿Ð»Ð¸Ñ‚'
        ],
        'phrases': [
            'Ð±Ñ€Ð¾ÐºÐµÑ€ÑÐºÐ¸Ð¹ ÑÑ‡ÐµÑ‚', 'Ð¸Ð½Ð²ÐµÑÑ‚Ð¸Ñ†Ð¸Ð¾Ð½Ð½Ñ‹Ð¹ ÑÑ‡ÐµÑ‚', 'Ð¿Ð°ÐµÐ²Ð¾Ð¹ Ñ„Ð¾Ð½Ð´',
            'ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð½Ñ‹Ð¹ Ð¿Ñ€Ð¾Ð´ÑƒÐºÑ‚', 'ÐºÑƒÐ¿Ð¸Ñ‚ÑŒ Ð°ÐºÑ†Ð¸Ð¸', 'Ð¸Ð½Ð²ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ð´ÐµÐ½ÑŒÐ³Ð¸',
            'Ð¸Ð½Ð´Ð¸Ð²Ð¸Ð´ÑƒÐ°Ð»ÑŒÐ½Ñ‹Ð¹ Ð¸Ð½Ð²ÐµÑÑ‚Ð¸Ñ†Ð¸Ð¾Ð½Ð½Ñ‹Ð¹ ÑÑ‡ÐµÑ‚', 'Ñ†ÐµÐ½Ð½Ñ‹Ðµ Ð±ÑƒÐ¼Ð°Ð³Ð¸',
            'Ñ‚Ð¾Ñ€Ð³Ð¾Ð²Ð»Ñ Ð½Ð° Ð±Ð¸Ñ€Ð¶Ðµ', 'Ð¸Ð½Ð²ÐµÑÑ‚Ð¸Ñ†Ð¸Ð¾Ð½Ð½Ñ‹Ð¹ Ð¿Ð¾Ñ€Ñ‚Ñ„ÐµÐ»ÑŒ', 'Ð´Ð¾Ñ…Ð¾Ð´Ð½Ð¾ÑÑ‚ÑŒ Ð¸Ð½Ð²ÐµÑÑ‚Ð¸Ñ†Ð¸Ð¹',
            'Ð¿Ð¾ÐºÑƒÐ¿ÐºÐ° Ð°ÐºÑ†Ð¸Ð¹', 'Ð¿Ñ€Ð¾Ð´Ð°Ð¶Ð° Ð¾Ð±Ð»Ð¸Ð³Ð°Ñ†Ð¸Ð¹', 'Ð´Ð¸Ð²Ð¸Ð´ÐµÐ½Ð´Ð½Ñ‹Ðµ Ð²Ñ‹Ð¿Ð»Ð°Ñ‚Ñ‹',
            'ÐºÑƒÐ¿Ð¾Ð½Ð½Ñ‹Ð¹ Ð´Ð¾Ñ…Ð¾Ð´', 'ÑƒÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ð¿Ð¾Ñ€Ñ‚Ñ„ÐµÐ»ÐµÐ¼', 'Ð¸Ð½Ð²ÐµÑÑ‚Ð¸Ñ†Ð¸Ð¾Ð½Ð½Ñ‹Ð¹ Ñ€Ð¸ÑÐº',
            'Ð±Ð¸Ñ€Ð¶ÐµÐ²Ñ‹Ðµ Ñ‚Ð¾Ñ€Ð³Ð¸', 'Ð»Ð¸Ñ†ÐµÐ½Ð·Ð¸Ñ Ð±Ñ€Ð¾ÐºÐµÑ€Ð°', 'Ñ‚Ð°Ñ€Ð¸Ñ„Ñ‹ Ð½Ð° Ð¾Ð±ÑÐ»ÑƒÐ¶Ð¸Ð²Ð°Ð½Ð¸Ðµ',
            'Ð¸Ð½Ð²ÐµÑÑ‚Ð¸Ñ†Ð¸Ð¾Ð½Ð½Ð°Ñ ÑÑ‚Ñ€Ð°Ñ‚ÐµÐ³Ð¸Ñ', 'Ñ„Ð¸Ð½Ð°Ð½ÑÐ¾Ð²Ñ‹Ð¹ ÑÐ¾Ð²ÐµÑ‚Ð½Ð¸Ðº',
            # Ð”Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ð¾Ñ‚ Ð¼ÐµÐ½Ñ
            'Ñ‚Ð¾Ñ€Ð³Ð¾Ð²Ð»Ñ Ñ„ÑŒÑŽÑ‡ÐµÑ€ÑÐ°Ð¼Ð¸', 'Ð¾Ð¿Ñ†Ð¸Ð¾Ð½Ð½Ñ‹Ðµ ÐºÐ¾Ð½Ñ‚Ñ€Ð°ÐºÑ‚Ñ‹', 'Ð´Ð¸Ð²ÐµÑ€ÑÐ¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸Ñ Ð¿Ð¾Ñ€Ñ‚Ñ„ÐµÐ»Ñ',
            'Ð¼Ð°Ñ€Ð¶Ð¸Ð½Ð°Ð»ÑŒÐ½Ð°Ñ Ñ‚Ð¾Ñ€Ð³Ð¾Ð²Ð»Ñ', 'ipo ÐºÐ¾Ð¼Ð¿Ð°Ð½Ð¸Ð¸', 'ÑÐ¿Ð»Ð¸Ñ‚ Ð°ÐºÑ†Ð¸Ð¹'
        ]
    },
    'Ð¡Ñ‚Ñ€Ð°Ñ…Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¸ Ð·Ð°Ñ‰Ð¸Ñ‚Ð°': {
        'keywords': [
            'ÑÑ‚Ñ€Ð°Ñ…Ð¾Ð²', 'Ð·Ð°Ñ‰Ð¸Ñ‚', 'Ð¿ÑƒÑ‚ÐµÑˆÐµÑÑ‚Ð²', 'Ð¸Ð¼ÑƒÑ‰ÐµÑÑ‚Ð²', 'Ð½ÐµÑÑ‡Ð°ÑÑ‚Ð½', 
            'ÑÐ»ÑƒÑ‡Ð°', 'Ð±Ð¾Ð»ÐµÐ·Ð½', 'Ñ€Ð¸ÑÐº', 'Ð¿Ð¾Ð»Ð¸Ñ', 'ÑÑ‚Ñ€Ð°Ñ…Ð¾Ð²Ðº', 'Ð²Ñ‹Ð¿Ð»Ð°Ñ‚',
            'ÐºÐ¾Ð¼Ð¿ÐµÐ½ÑÐ°Ñ†', 'Ð´Ñ‚Ð¿', 'Ð°Ð²Ð°Ñ€Ð¸Ñ', 'Ð·Ð´Ð¾Ñ€Ð¾Ð²', 'Ð¶Ð¸Ð·Ð½', 'Ð½ÐµÐ´Ð²Ð¸Ð¶',
            'ÐºÐ²Ð°Ñ€Ñ‚Ð¸Ñ€', 'Ð´Ð¾Ð¼', 'Ð¼Ð°ÑˆÐ¸Ð½', 'Ð°Ð²Ñ‚Ð¾', 'Ð»ÐµÑ‡ÐµÐ½', 'Ð±Ð¾Ð»ÑŒÐ½Ð¸Ñ‡Ð½',
            'Ð³Ð¾ÑÐ¿Ð¸Ñ‚Ð°Ð»Ð¸Ð·Ð°Ñ†', 'Ð¾Ð¿Ð»Ð°Ñ‚', 'Ð±Ð¾Ð»ÑŒÐ½Ð¸Ñ†', 'Ð»ÐµÐºÐ°Ñ€ÑÑ‚Ð²', 'ÑƒÑ‰ÐµÑ€Ð±', 'Ð¿Ð¾Ð²Ñ€ÐµÐ¶Ð´ÐµÐ½',
            'ÐºÑ€Ð°Ð¶', 'Ð¿Ð¾Ð¶Ð°Ñ€', 'Ð·Ð°Ñ‚Ð¾Ð¿Ð»ÐµÐ½', 'Ð¾Ñ‚Ð²ÐµÑ‚ÑÑ‚Ð²ÐµÐ½Ð½Ð¾ÑÑ‚', 'Ð³Ñ€Ð°Ð¶Ð´Ð°Ð½ÑÐº',
            # Ð”Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ð¾Ñ‚ Ð¼ÐµÐ½Ñ
            'ÐºÐ°ÑÐºÐ¾', 'Ð¾ÑÐ°Ð³Ð¾', 'Ð´Ð¼Ñ', 'Ð²Ð·Ñ€', 'Ñ‚ÑƒÑ€Ð¸ÑÑ‚', 'Ð¼ÐµÐ´ÑÑ‚Ñ€Ð°Ñ…Ð¾Ð²Ðº', 
            'ÑÐºÑÑ‚Ñ€ÐµÐ½', 'ÑÐ²Ð°ÐºÑƒÐ°Ñ†', 'Ñ€ÐµÐ¿Ð°Ñ‚Ñ€Ð¸Ð°Ñ†', 'ÑÑ‚Ñ€Ð°Ñ…Ð¾Ð²Ð°Ñ‚ÐµÐ»', 'Ð²Ñ‹Ð³Ð¾Ð´Ð¾Ð¿Ñ€Ð¸Ð¾Ð±Ñ€ÐµÑ‚Ð°Ñ‚ÐµÐ»'
        ],
        'phrases': [
            'ÑÑ‚Ñ€Ð°Ñ…Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¿ÑƒÑ‚ÐµÑˆÐµÑÑ‚Ð²ÐµÐ½Ð½Ð¸ÐºÐ¾Ð²', 'ÑÑ‚Ñ€Ð°Ñ…Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¸Ð¼ÑƒÑ‰ÐµÑÑ‚Ð²Ð°',
            'ÑÑ‚Ñ€Ð°Ñ…Ð¾Ð²Ð¾Ð¹ Ð¿Ð¾Ð»Ð¸Ñ', 'ÑÑ‚Ñ€Ð°Ñ…Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¾Ñ‚ Ð½ÐµÑÑ‡Ð°ÑÑ‚Ð½Ñ‹Ñ… ÑÐ»ÑƒÑ‡Ð°ÐµÐ²',
            'ÑÑ‚Ñ€Ð°Ñ…Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð·Ð´Ð¾Ñ€Ð¾Ð²ÑŒÑ', 'ÑÑ‚Ñ€Ð°Ñ…Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¶Ð¸Ð·Ð½Ð¸', 'ÑÑ‚Ñ€Ð°Ñ…Ð¾Ð²Ð°Ð½Ð¸Ðµ ÐºÐ²Ð°Ñ€Ñ‚Ð¸Ñ€Ñ‹',
            'ÑÑ‚Ñ€Ð°Ñ…Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð°Ð²Ñ‚Ð¾Ð¼Ð¾Ð±Ð¸Ð»Ñ', 'ÑÑ‚Ñ€Ð°Ñ…Ð¾Ð²Ð¾Ð¹ ÑÐ»ÑƒÑ‡Ð°Ð¹', 'ÑÑ‚Ñ€Ð°Ñ…Ð¾Ð²Ð°Ñ Ð²Ñ‹Ð¿Ð»Ð°Ñ‚Ð°',
            'ÐºÐ¾Ð¼Ð¿ÐµÐ½ÑÐ°Ñ†Ð¸Ñ ÑƒÑ‰ÐµÑ€Ð±Ð°', 'Ð´Ð¾Ð±Ñ€Ð¾Ð²Ð¾Ð»ÑŒÐ½Ð¾Ðµ ÑÑ‚Ñ€Ð°Ñ…Ð¾Ð²Ð°Ð½Ð¸Ðµ', 'Ð¾Ð±ÑÐ·Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ðµ ÑÑ‚Ñ€Ð°Ñ…Ð¾Ð²Ð°Ð½Ð¸Ðµ',
            'ÑÑ‚Ñ€Ð°Ñ…Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¾Ñ‚Ð²ÐµÑ‚ÑÑ‚Ð²ÐµÐ½Ð½Ð¾ÑÑ‚Ð¸', 'ÑÑ‚Ñ€Ð°Ñ…Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¸Ð¿Ð¾Ñ‚ÐµÐºÐ¸', 'Ð¼ÐµÐ´Ð¸Ñ†Ð¸Ð½ÑÐºÐ°Ñ ÑÑ‚Ñ€Ð°Ñ…Ð¾Ð²ÐºÐ°',
            'ÑÑ‚Ñ€Ð°Ñ…Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð²Ñ‹ÐµÐ·Ð¶Ð°ÑŽÑ‰Ð¸Ñ… Ð·Ð° Ñ€ÑƒÐ±ÐµÐ¶', 'ÑÑ‚Ñ€Ð°Ñ…Ð¾Ð²Ð¾Ðµ Ð²Ð¾Ð·Ð¼ÐµÑ‰ÐµÐ½Ð¸Ðµ',
            'Ð¾Ñ„Ð¾Ñ€Ð¼Ð¸Ñ‚ÑŒ ÑÑ‚Ñ€Ð°Ñ…Ð¾Ð²ÐºÑƒ', 'Ð¾Ñ‚ÐºÐ°Ð·Ð°Ð»Ð¸ Ð² Ð²Ñ‹Ð¿Ð»Ð°Ñ‚Ðµ', 'ÑÑ‚Ñ€Ð°Ñ…Ð¾Ð²Ð°Ñ ÐºÐ¾Ð¼Ð¿Ð°Ð½Ð¸Ñ',
            # Ð”Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ð¾Ñ‚ Ð¼ÐµÐ½Ñ
            'ÐºÐ°ÑÐºÐ¾ Ð½Ð° Ð°Ð²Ñ‚Ð¾', 'Ð¾ÑÐ°Ð³Ð¾ Ð¿Ð¾Ð»Ð¸Ñ', 'Ð´Ð¼Ñ Ð¿Ñ€Ð¾Ð³Ñ€Ð°Ð¼Ð¼Ð°', 'ÑÑ‚Ñ€Ð°Ñ…Ð¾Ð²ÐºÐ° Ð´Ð»Ñ Ñ‚ÑƒÑ€Ð¸ÑÑ‚Ð¾Ð²',
            'ÑÐºÑÑ‚Ñ€ÐµÐ½Ð½Ð°Ñ Ð¿Ð¾Ð¼Ð¾Ñ‰ÑŒ', 'Ð¼ÐµÐ´Ð¸Ñ†Ð¸Ð½ÑÐºÐ°Ñ ÑÐ²Ð°ÐºÑƒÐ°Ñ†Ð¸Ñ', 'Ñ€ÐµÐ¿Ð°Ñ‚Ñ€Ð¸Ð°Ñ†Ð¸Ñ Ñ‚ÐµÐ»Ð°'
        ]
    },
    'ÐŸÑ€ÐµÐ¼Ð¸Ð°Ð»ÑŒÐ½Ñ‹Ðµ ÑƒÑÐ»ÑƒÐ³Ð¸': {
        'keywords': [
            'Ð¿Ñ€Ð¸Ð²Ð°Ñ‚', 'Ð¿Ñ€ÐµÐ¼Ð¸ÑƒÐ¼', 'Ð´ÐµÐ¿Ð¾Ð·Ð¸Ñ‚Ð°Ñ€', 'ÑÑ‡ÐµÐ¹Ðº', 'ÐºÐ¾Ð½ÑÑƒÐ»ÑŒÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½', 
            'Ð¿Ð»Ð°Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½', 'Ð¿ÐµÑ€ÑÐ¾Ð½Ð°Ð»', 'Ð¼ÐµÐ½ÐµÐ´Ð¶ÐµÑ€', 'ÑÐºÑÐºÐ»ÑŽÐ·Ð¸Ð²', 'Ð²Ð¸Ð¿',
            'Ð¿ÐµÑ€ÑÐ¾Ð½Ð°Ð»ÑŒÐ½', 'Ð¾Ð±ÑÐ»ÑƒÐ¶Ð²Ð°Ð½', 'ÑƒÑÐ»ÑƒÐ³', 'Ð±Ð¾Ð³Ð°Ñ‚', 'ÑÐ¾ÑÑ‚Ð¾ÑÐ½',
            'ÐºÐ°Ð¿Ð¸Ñ‚Ð°Ð»', 'Ð½Ð°ÑÐ»ÐµÐ´', 'ÑÐ¾Ñ…Ñ€Ð°Ð½', 'Ð¿Ñ€Ð¸ÑƒÐ¼Ð½Ð¾Ð¶ÐµÐ½', 'ÑƒÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½',
            'Ð°ÐºÑ‚Ð¸Ð²', 'Ñ†ÐµÐ½Ð½Ð¾ÑÑ‚', 'Ð´Ñ€Ð°Ð³Ð¾Ñ†ÐµÐ½Ð½Ð¾ÑÑ‚', 'Ñ…Ñ€Ð°Ð½ÐµÐ½', 'ÑÐµÐ¹Ñ„',
            'ÐºÐ¾Ð½Ñ„Ð¸Ð´ÐµÐ½Ñ†Ð¸Ð°Ð»ÑŒÐ½', 'Ð¸Ð½Ð´Ð¸Ð²Ð¸Ð´ÑƒÐ°Ð»ÑŒÐ½', 'Ð¿Ð¾Ð´Ñ…Ð¾Ð´', 'Ñ€ÐµÑˆÐµÐ½',
            'Ñ„Ð¸Ð½Ð°Ð½ÑÐ¾Ð²', 'ÑÐ¾Ð²ÐµÑ‚', 'Ñ€ÐµÐºÐ¾Ð¼ÐµÐ½Ð´Ð°Ñ†', 'ÑÑ‚Ñ€Ð°Ñ‚ÐµÐ³', 'Ð¿Ð»Ð°Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½',
            # Ð”Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ð¾Ñ‚ Ð¼ÐµÐ½Ñ
            'ÑÐ»Ð¸Ñ‚', 'Ð¿Ñ€Ð¸Ð²Ð¸Ð»ÐµÐ³Ð¸', 'Ð»Ð°ÑƒÐ½Ð¶', 'ÐºÐ¾Ð½ÑÑŒÐµÑ€Ð¶', 'Ð¿Ñ€Ð¸Ð¾Ñ€Ð¸Ñ‚ÐµÑ‚', 
            'ÑÐµÐ¼ÐµÐ¹Ð½', 'Ñ‚Ñ€Ð°ÑÑ‚', 'Ð¾Ñ„Ñ„ÑˆÐ¾Ñ€', 'Ð½Ð°Ð»Ð¾Ð³Ð¾Ð²', 'Ð¾Ð¿Ñ‚Ð¸Ð¼Ð¸Ð·Ð°Ñ†', 'Ñ„Ð¸Ð»Ð°Ð½Ñ‚Ñ€Ð¾Ð¿'
        ],
        'phrases': [
            'Ð¿Ñ€Ð¸Ð²Ð°Ñ‚ Ð±Ð°Ð½ÐºÐ¸Ð½Ð³', 'Ð´ÐµÐ¿Ð¾Ð·Ð¸Ñ‚Ð°Ñ€Ð½Ð°Ñ ÑÑ‡ÐµÐ¹ÐºÐ°', 'Ñ„Ð¸Ð½Ð°Ð½ÑÐ¾Ð²Ð¾Ðµ Ð¿Ð»Ð°Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ',
            'Ð¿ÐµÑ€ÑÐ¾Ð½Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ð¼ÐµÐ½ÐµÐ´Ð¶ÐµÑ€', 'Ð¿Ñ€ÐµÐ¼Ð¸Ð°Ð»ÑŒÐ½Ð¾Ðµ Ð¾Ð±ÑÐ»ÑƒÐ¶Ð¸Ð²Ð°Ð½Ð¸Ðµ', 'Ð²Ð¸Ð¿ ÐºÐ»Ð¸ÐµÐ½Ñ‚',
            'Ð¸Ð½Ð´Ð¸Ð²Ð¸Ð´ÑƒÐ°Ð»ÑŒÐ½Ñ‹Ð¹ Ð¿Ð¾Ð´Ñ…Ð¾Ð´', 'ÑƒÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ ÐºÐ°Ð¿Ð¸Ñ‚Ð°Ð»Ð¾Ð¼', 'ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ðµ Ð±Ð¾Ð³Ð°Ñ‚ÑÑ‚Ð²Ð°',
            'Ð¿Ñ€Ð¸ÑƒÐ¼Ð½Ð¾Ð¶ÐµÐ½Ð¸Ðµ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ñ', 'Ñ„Ð¸Ð½Ð°Ð½ÑÐ¾Ð²Ð¾Ðµ ÐºÐ¾Ð½ÑÑƒÐ»ÑŒÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ', 'Ð±Ð°Ð½ÐºÐ¾Ð²ÑÐºÐ°Ñ ÑÑ‡ÐµÐ¹ÐºÐ°',
            'Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ðµ Ñ†ÐµÐ½Ð½Ð¾ÑÑ‚ÐµÐ¹', 'ÑÐµÐ¹Ñ„Ð¾Ð²Ð°Ñ ÑÑ‡ÐµÐ¹ÐºÐ°', 'ÐºÐ¾Ð½Ñ„Ð¸Ð´ÐµÐ½Ñ†Ð¸Ð°Ð»ÑŒÐ½Ð¾Ðµ Ð¾Ð±ÑÐ»ÑƒÐ¶Ð¸Ð²Ð°Ð½Ð¸Ðµ',
            'Ð¸Ð½Ð²ÐµÑÑ‚Ð¸Ñ†Ð¸Ð¾Ð½Ð½Ð°Ñ ÑÑ‚Ñ€Ð°Ñ‚ÐµÐ³Ð¸Ñ', 'Ð¿Ð»Ð°Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð½Ð°ÑÐ»ÐµÐ´ÑÑ‚Ð²Ð°', 'ÑÐºÑÐºÐ»ÑŽÐ·Ð¸Ð²Ð½Ñ‹Ðµ Ð¿Ñ€Ð¾Ð´ÑƒÐºÑ‚Ñ‹',
            'Ð¿ÐµÑ€ÑÐ¾Ð½Ð°Ð»ÑŒÐ½Ñ‹Ðµ ÑƒÑÐ»Ð¾Ð²Ð¸Ñ', 'ÑƒÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ð°ÐºÑ‚Ð¸Ð²Ð°Ð¼Ð¸', 'Ñ„Ð¸Ð½Ð°Ð½ÑÐ¾Ð²Ñ‹Ð¹ ÑÐ¾Ð²ÐµÑ‚',
            # Ð”Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ð¾Ñ‚ Ð¼ÐµÐ½Ñ
            'ÑÐ»Ð¸Ñ‚Ð½Ñ‹Ð¹ ÐºÐ»ÑƒÐ±', 'Ð¿Ñ€Ð¸Ð²Ð¸Ð»ÐµÐ³Ð¸Ð¸ Ð²Ð¸Ð¿', 'ÐºÐ¾Ð½ÑÑŒÐµÑ€Ð¶ ÑÐµÑ€Ð²Ð¸Ñ', 'Ð¿Ñ€Ð¸Ð¾Ñ€Ð¸Ñ‚ÐµÑ‚Ð½Ð¾Ðµ Ð¾Ð±ÑÐ»ÑƒÐ¶Ð¸Ð²Ð°Ð½Ð¸Ðµ',
            'ÑÐµÐ¼ÐµÐ¹Ð½Ñ‹Ð¹ Ð¾Ñ„Ð¸Ñ', 'Ñ‚Ñ€Ð°ÑÑ‚Ð¾Ð²Ñ‹Ð¹ Ñ„Ð¾Ð½Ð´', 'Ð½Ð°Ð»Ð¾Ð³Ð¾Ð²Ð°Ñ Ð¾Ð¿Ñ‚Ð¸Ð¼Ð¸Ð·Ð°Ñ†Ð¸Ñ', 'Ð¾Ñ„Ñ„ÑˆÐ¾Ñ€Ð½Ñ‹Ðµ ÑÑ‡ÐµÑ‚Ð°'
        ]
    }
}

# Ð›ÐµÐºÑÐ¸ÐºÐ¾Ð½ Ñ‚Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾ÑÑ‚Ð¸
SENTIMENT_LEXICON = {
    'positive': {
        'Ð¾Ñ‚Ð»Ð¸Ñ‡Ð½': 2, 'Ñ…Ð¾Ñ€Ð¾Ñˆ': 2, 'Ð¿Ñ€ÐµÐºÑ€Ð°ÑÐ½': 2, 'Ð±Ñ‹ÑÑ‚Ñ€': 1, 'ÑƒÐ´Ð¾Ð±Ð½': 1, 'Ð¿Ð¾Ð½ÑÑ‚Ð½': 1,
        'Ñ€ÐµÐºÐ¾Ð¼ÐµÐ½Ð´': 2, 'Ð´Ð¾Ð²Ð¾Ð»': 2, 'ÑÐ¿Ð°ÑÐ¸Ð±': 2, 'Ñ€Ð°Ð´': 2, 'Ð»ÐµÐ³Ðº': 1, 'Ð¿Ñ€Ð¸ÑÑ‚Ð½': 1,
        'ÐºÐ°Ñ‡ÐµÑÑ‚Ð²ÐµÐ½': 2, 'Ð¿Ñ€Ð¾Ñ„ÐµÑÑÐ¸Ð¾Ð½Ð°Ð»': 2, 'Ð¾Ð¿ÐµÑ€Ð°Ñ‚Ð¸Ð²': 1, 'Ñ‡ÐµÑ‚Ðº': 1, 'Ð¿Ñ€Ð¾Ð·Ñ€Ð°Ñ‡Ð½': 1,
        'Ð²Ñ‹Ð³Ð¾Ð´Ð½': 2, 'Ð½Ð°Ð´ÐµÐ¶Ð½': 2, 'Ð»ÑƒÑ‡Ñˆ': 2, 'ÑÑƒÐ¿ÐµÑ€': 2, 'Ð·Ð°Ð¼ÐµÑ‡Ð°Ñ‚ÐµÐ»ÑŒÐ½': 2, 'Ð²Ð¿ÐµÑ‡Ð°Ñ‚Ð»': 2,
        'ÑƒÐ´Ð¾Ð²Ð»ÐµÑ‚Ð²Ð¾Ñ€ÐµÐ½': 2, 'Ð¿Ð¾Ð½Ñ€Ð°Ð²Ð¸Ð»Ð¾ÑÑŒ': 2, 'Ð½Ñ€Ð°Ð²Ð¸Ñ‚ÑÑ': 2, 'Ð²Ð¾Ð²Ñ€ÐµÐ¼Ñ': 1, 'ÑÐ²Ð¾ÐµÐ²Ñ€ÐµÐ¼ÐµÐ½': 1,
        'Ð³Ð»Ð°Ð´ÐºÐ¾': 1, 'ÑÑ„Ñ„ÐµÐºÑ‚Ð¸Ð²Ð½': 1, 'Ð±ÐµÐ· Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼': 2, 'Ð½Ðµ Ð¿Ð»Ð¾Ñ…Ð¾': 1, 'Ð±ÐµÐ· Ð¾ÑˆÐ¸Ð±Ð¾Ðº': 2,
    },
    'negative': {
        'Ð¿Ð»Ð¾Ñ…': -2, 'ÑƒÐ¶Ð°ÑÐ½': -3, 'Ð¼ÐµÐ´Ð»ÐµÐ½': -2, 'Ð½ÐµÑƒÐ´Ð¾Ð±Ð½': -2, 'ÑÐ»Ð¾Ð¶Ð½': -2, 'Ð½Ðµ Ð½Ñ€Ð°Ð²Ð¸Ñ‚ÑÑ': -3,
        'Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼': -2, 'Ð¾ÑˆÐ¸Ð±Ðº': -2, 'Ð³Ð»ÑŽÐº': -2, 'Ð·Ð°Ð²Ð¸ÑÐ°': -2, 'Ð½Ðµ Ñ€Ð°Ð±Ð¾Ñ‚': -3, 'Ð¾Ñ‚ÐºÐ°Ð·': -2,
        'Ð¾Ð±Ð¼Ð°Ð½': -3, 'Ð´Ð¾Ñ€Ð¾Ð³': -2, 'ÐºÐ¾Ð¼Ð¸ÑÑ': -1, 'Ð´Ð¾Ð»Ð³': -2, 'Ð½ÐµÑÑÐ½': -1, 'Ð½ÐµÐ¿Ð¾Ð»Ð°Ð´Ðº': -2,
        'Ð½ÐµÐ´Ð¾Ð²Ð¾Ð»': -2, 'Ñ€Ð°Ð·Ð¾Ñ‡Ð°Ñ€Ð¾Ð²Ð°Ð½': -3, 'ÐºÐ¾ÑˆÐ¼Ð°Ñ€': -3, 'Ð·Ð°Ð²Ð¸ÑÐ°ÐµÑ‚': -2, 'Ð²Ð¸ÑÐ½ÐµÑ‚': -2, 'Ñ‚ÑƒÐ¿Ð¸Ñ‚': -2,
        'Ð»Ð°Ð³Ð°ÐµÑ‚': -2, 'Ð¼Ð°Ð»ÐµÐ½ÑŒÐº': -1
    }
}

NEGATION_WORDS = {'Ð½Ðµ', 'Ð½ÐµÑ‚', 'Ð½Ð¸', 'Ð±ÐµÐ·', 'Ð½ÐµÐ»ÑŒÐ·Ñ', 'Ð½ÐµÐ²Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾', 'Ð½Ð¸ÐºÐ°Ðº', 'Ð½Ð¸Ñ‡ÑƒÑ‚ÑŒ'}

def classify_sentiment(text):
    text = text.lower()
    score = 0
    words = re.findall(r'\w+', text)
    for i, word in enumerate(words):
        for sentiment, lex in SENTIMENT_LEXICON.items():
            for key, val in lex.items():
                if key in word:
                    adjusted_val = val
                    if i > 0 and words[i-1] in NEGATION_WORDS:
                        adjusted_val = -adjusted_val
                    score += adjusted_val
                    break
    if score > 0.5:
        return 'Ð¿Ð¾Ð»Ð¾Ð¶Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾'
    elif score < -0.5:
        return 'Ð¾Ñ‚Ñ€Ð¸Ñ†Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð¾'
    else:
        return 'Ð½ÐµÐ¹Ñ‚Ñ€Ð°Ð»ÑŒÐ½Ð¾'

def extract_topic_from_fragment(fragment):
    """Ð’Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÑ‚ Ð¢ÐžÐ›Ð¬ÐšÐž Ð¾Ð´Ð½Ñƒ Ñ‚ÐµÐ¼Ñƒ: ÑÐ½Ð°Ñ‡Ð°Ð»Ð° Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑÐµÑ‚ Ð¿Ð¾ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸ÑÐ¼"""
    fragment = fragment.lower()
    words = set(re.findall(r'\w+', fragment))
    
    # ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸ (Ñ‚ÐµÐ¿ÐµÑ€ÑŒ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸, Ð±ÐµÐ· subcat, Ñ‚Ð°Ðº ÐºÐ°Ðº Ð² Ð¿Ñ€Ð¸Ð¼ÐµÑ€Ðµ topics - ÑÑ‚Ð¾ subcat Ð¸Ð»Ð¸ Ð¿Ñ€Ð¾ÑÑ‚Ñ‹Ðµ Ñ‚ÐµÐ¼Ñ‹)
    for category, data in KEYWORDS.items():
        if any(kw in fragment for kw in data['phrases']) or any(w in words for w in data['keywords']):
            return category
    
    return 'Ð”Ñ€ÑƒÐ³Ð¾Ðµ'  # Ð¢Ð¾Ð»ÑŒÐºÐ¾ Ð² ÐºÑ€Ð°Ð¹Ð½ÐµÐ¼ ÑÐ»ÑƒÑ‡Ð°Ðµ

def random_review_date():
    return '31.05.2025'  # Ð£ÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð° Ñ„Ð¸ÐºÑÐ¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ð°Ñ Ð´Ð°Ñ‚Ð°, ÐµÑÐ»Ð¸ Ð´Ð°Ñ‚Ð° Ð½Ðµ ÑƒÐºÐ°Ð·Ð°Ð½Ð°

def process_review(review):
    text = review.get('text', '')
    id = review.get('id', 0)
    
    # Ð Ð°Ð·Ð±Ð¸Ð²Ð°ÐµÐ¼ Ð½Ð° Ñ‡Ð°ÑÑ‚Ð¸ Ð¿Ð¾ ÑÐ¾ÑŽÐ·Ð°Ð¼-Ñ€Ð°Ð·Ð´ÐµÐ»Ð¸Ñ‚ÐµÐ»ÑÐ¼
    parts = re.split(r'\b(Ð½Ð¾|Ð·Ð°Ñ‚Ð¾|Ð¾Ð´Ð½Ð°ÐºÐ¾|Ð° Ñ‚Ð°ÐºÐ¶Ðµ|Ð¿Ñ€Ð¸ ÑÑ‚Ð¾Ð¼|Ð¸|Ð½Ð¾ Ð¿Ñ€Ð¸ ÑÑ‚Ð¾Ð¼)\b', text, flags=re.IGNORECASE)
    fragments = []
    for i in range(0, len(parts), 2):
        frag = parts[i].strip()
        if i + 1 < len(parts):
            frag += ' ' + parts[i+1].strip()
        if frag:
            fragments.append(frag.strip())
    
    if not fragments:
        fragments = [text]
    
    topics = []
    sentiments = []
    
    for frag in fragments:
        topic = extract_topic_from_fragment(frag)
        if topic == 'Ð”Ñ€ÑƒÐ³Ð¾Ðµ' and len(fragments) > 1:
            continue  # ÐŸÑ€Ð¾Ð¿ÑƒÑÐºÐ°ÐµÐ¼ 'Ð”Ñ€ÑƒÐ³Ð¾Ðµ' ÐµÑÐ»Ð¸ ÐµÑÑ‚ÑŒ Ð´Ñ€ÑƒÐ³Ð¸Ðµ Ñ„Ñ€Ð°Ð³Ð¼ÐµÐ½Ñ‚Ñ‹
        sentiment = classify_sentiment(frag)
        topics.append(topic)
        sentiments.append(sentiment)
    
    # Ð•ÑÐ»Ð¸ Ð²ÑÐµ 'Ð”Ñ€ÑƒÐ³Ð¾Ðµ', Ð¾ÑÑ‚Ð°Ð²Ð»ÑÐµÐ¼ Ð¾Ð´Ð¸Ð½
    if all(t == 'Ð”Ñ€ÑƒÐ³Ð¾Ðµ' for t in topics):
        topics = ['Ð”Ñ€ÑƒÐ³Ð¾Ðµ']
        sentiments = [classify_sentiment(text)]
    
    # Ð£Ð´Ð°Ð»ÑÐµÐ¼ Ð´ÑƒÐ±Ð»Ð¸ÐºÐ°Ñ‚Ñ‹ Ñ‚ÐµÐ¼
    unique = list(dict.fromkeys(zip(topics, sentiments)))
    topics, sentiments = zip(*unique) if unique else (['Ð”Ñ€ÑƒÐ³Ð¾Ðµ'], [classify_sentiment(text)])
    
    # ÐžÐ¿Ñ€ÐµÐ´ÐµÐ»ÑÐµÐ¼ rating
    if len(set(sentiments)) > 1:
        rating = 3
    else:
        first_sent = sentiments[0]
        if first_sent == 'Ð¿Ð¾Ð»Ð¾Ð¶Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾':
            rating = 5
        elif first_sent == 'Ð¾Ñ‚Ñ€Ð¸Ñ†Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð¾':
            rating = 1
        else:
            rating = 3
    
    return {
        'id': id,
        'text': text,
        'topics': ', '.join(topics),
        'sentiments': ', '.join(sentiments),
        'product_category': ', '.join(topics),
        'date': random_review_date(),
        'rating': rating,
        'author': review.get('author', 'ÐšÐ»Ð¸ÐµÐ½Ñ‚ Ð±Ð°Ð½ÐºÐ°'),
        'source': 'gold'
    }

@st.cache_data
def load_data(uploaded_file):
    if uploaded_file is not None:
        try:
            data = json.load(uploaded_file)
            if 'data' in data and isinstance(data['data'], list):
                predictions = [process_review(review) for review in data['data']]
                df = pd.DataFrame(predictions)
                if not df.empty:
                    df['date'] = pd.to_datetime(df['date'], format='%d.%m.%Y')
                    st.info(f"Ð—Ð°Ð³Ñ€ÑƒÐ¶ÐµÐ½Ð¾ {len(df)} Ð¾Ñ‚Ð·Ñ‹Ð²Ð¾Ð²")
                    return df
        except Exception as e:
            st.error(f"ÐžÑˆÐ¸Ð±ÐºÐ° Ð¿Ñ€Ð¸ Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐµ JSON: {e}")
    st.error("ÐÐµÐ²ÐµÑ€Ð½Ñ‹Ð¹ Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚ JSON. ÐžÐ¶Ð¸Ð´Ð°ÐµÑ‚ÑÑ {'data': [{'id': 1, 'text': '...'}]}")
    return pd.DataFrame()

# Ð¡Ð°Ð¹Ð´Ð±Ð°Ñ€
st.sidebar.header("Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° Ð¸ Ñ„Ð¸Ð»ÑŒÑ‚Ñ€Ñ‹")
uploaded_json = st.sidebar.file_uploader("Ð—Ð°Ð³Ñ€ÑƒÐ·Ð¸Ñ‚Ðµ JSON Ñ Ð¾Ñ‚Ð·Ñ‹Ð²Ð°Ð¼Ð¸", type=['json'])

if uploaded_json:
    df = load_data(uploaded_json)
    if not df.empty:
        st.sidebar.header("Ð¤Ð¸Ð»ÑŒÑ‚Ñ€Ñ‹")
        min_date = df['date'].min().date()
        max_date = df['date'].max().date()
        start_date = st.sidebar.date_input("ÐÐ°Ñ‡Ð°Ð»ÑŒÐ½Ð°Ñ Ð´Ð°Ñ‚Ð°", min_date, min_value=min_date, max_value=max_date)
        end_date = st.sidebar.date_input("ÐšÐ¾Ð½ÐµÑ‡Ð½Ð°Ñ Ð´Ð°Ñ‚Ð°", max_date, min_value=min_date, max_value=max_date)

        rating_filter = st.sidebar.slider("Ð ÐµÐ¹Ñ‚Ð¸Ð½Ð³", min_value=1, max_value=5, value=(1, 5))

        selected_categories = st.sidebar.multiselect("ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸", options=ALL_CATEGORIES, default=[])

        if selected_categories:
            available_subcategories = [sub for cat in selected_categories for sub in PRODUCT_CATEGORIES.get(cat, [])]
            selected_subcategories = st.sidebar.multiselect("ÐŸÐ¾Ð´ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸", options=available_subcategories, default=[])
        else:
            selected_subcategories = []

        # Ð¤Ð¸Ð»ÑŒÑ‚Ñ€Ð°Ñ†Ð¸Ñ
        mask = (df['date'].dt.date >= start_date) & (df['date'].dt.date <= end_date) & (df['rating'].between(*rating_filter))
        
        if selected_categories:
            mask &= df['product_category'].str.contains('|'.join(selected_categories), case=False, na=False)
        if selected_subcategories:
            mask &= df['product_category'].str.contains('|'.join(selected_subcategories), case=False, na=False)

        filtered_df = df[mask].copy()

        # Ð’Ñ‹Ð²Ð¾Ð´
        st.subheader("ðŸ“ ÐŸÐ¾Ð´Ñ€Ð¾Ð±Ð½Ñ‹Ðµ Ð¾Ñ‚Ð·Ñ‹Ð²Ñ‹")
        st.dataframe(filtered_df[['id', 'text', 'topics', 'sentiments', 'rating', 'date']])

        # Ð¢Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾ÑÑ‚ÑŒ
        st.subheader("ðŸ˜Š Ð Ð°ÑÐ¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð¸Ðµ Ñ‚Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾ÑÑ‚Ð¸")
        if not filtered_df.empty:
            exploded = filtered_df.copy()
            exploded['sentiments_list'] = exploded['sentiments'].str.split(', ')
            exploded = exploded.explode('sentiments_list')
            sentiment_counts = exploded['sentiments_list'].value_counts()
            fig_sentiment = px.pie(
                names=sentiment_counts.index,
                values=sentiment_counts.values,
                title="Ð¢Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾ÑÑ‚ÑŒ Ð¾Ñ‚Ð·Ñ‹Ð²Ð¾Ð²",
                color=sentiment_counts.index,
                color_discrete_map={'Ð¿Ð¾Ð»Ð¾Ð¶Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾': '#90EE90', 'Ð¾Ñ‚Ñ€Ð¸Ñ†Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð¾': '#FF6347', 'Ð½ÐµÐ¹Ñ‚Ñ€Ð°Ð»ÑŒÐ½Ð¾': '#D3D3D3'}
            )
            st.plotly_chart(fig_sentiment, use_container_width=True)

        # Ð Ð°ÑÐ¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð¸Ðµ Ð¿Ð¾ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸ÑÐ¼
        st.subheader("ðŸ“‹ Ð Ð°ÑÐ¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð¸Ðµ Ð¿Ð¾ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸ÑÐ¼ Ð¿Ñ€Ð¾Ð´ÑƒÐºÑ‚Ð¾Ð²")
        if not filtered_df.empty:
            exploded_cat = filtered_df.copy()
            exploded_cat['cat_list'] = exploded_cat['product_category'].str.split(', ')
            exploded_cat = exploded_cat.explode('cat_list')
            if not selected_categories:
                # ÐÐ³Ñ€ÐµÐ³Ð¸Ñ€ÑƒÐµÐ¼ Ð¿Ð¾ Ð¾ÑÐ½Ð¾Ð²Ð½Ñ‹Ð¼ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸ÑÐ¼, ÐµÑÐ»Ð¸ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸ Ð½Ðµ Ð²Ñ‹Ð±Ñ€Ð°Ð½Ñ‹
                exploded_cat['cat_list'] = exploded_cat['cat_list'].apply(lambda x: SUBCAT_TO_CAT.get(x.strip(), x) if x != 'Ð”Ñ€ÑƒÐ³Ð¾Ðµ' else x)
                exploded_cat = exploded_cat[exploded_cat['cat_list'] != 'Ð”Ñ€ÑƒÐ³Ð¾Ðµ']  # Ð£Ð´Ð°Ð»ÑÐµÐ¼ 'Ð”Ñ€ÑƒÐ³Ð¾Ðµ'
                cat_counts = exploded_cat['cat_list'].value_counts()
                fig_cat = px.bar(
                    x=cat_counts.index,
                    y=cat_counts.values,
                    title="ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸ Ð¸ Ð¿Ð¾Ð´ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸",
                    labels={'x': 'Ð¢ÐµÐ¼Ð°', 'y': 'ÐšÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð¾Ñ‚Ð·Ñ‹Ð²Ð¾Ð²'},
                    color=cat_counts.index,
                    color_discrete_map={
                        'ÐŸÐ¾Ð²ÑÐµÐ´Ð½ÐµÐ²Ð½Ñ‹Ðµ Ñ„Ð¸Ð½Ð°Ð½ÑÑ‹ Ð¸ Ð¿Ð»Ð°Ñ‚ÐµÐ¶Ð¸': '#FF9999',
                        'Ð¡Ð±ÐµÑ€ÐµÐ¶ÐµÐ½Ð¸Ñ Ð¸ Ð½Ð°ÐºÐ¾Ð¿Ð»ÐµÐ½Ð¸Ñ': '#66B2FF',
                        'ÐšÑ€ÐµÐ´Ð¸Ñ‚Ð¾Ð²Ð°Ð½Ð¸Ðµ': '#99FF99',
                        'Ð˜Ð½Ð²ÐµÑÑ‚Ð¸Ñ†Ð¸Ð¸': '#FFCC99',
                        'Ð¡Ñ‚Ñ€Ð°Ñ…Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¸ Ð·Ð°Ñ‰Ð¸Ñ‚Ð°': '#FF99CC',
                        'ÐŸÑ€ÐµÐ¼Ð¸Ð°Ð»ÑŒÐ½Ñ‹Ðµ ÑƒÑÐ»ÑƒÐ³Ð¸': '#C2C2F0'
                    }
                )
            else:
                cat_counts = exploded_cat['cat_list'].value_counts()
                fig_cat = px.bar(
                    x=cat_counts.index,
                    y=cat_counts.values,
                    title="ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸ Ð¸ Ð¿Ð¾Ð´ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸",
                    labels={'x': 'Ð¢ÐµÐ¼Ð°', 'y': 'ÐšÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð¾Ñ‚Ð·Ñ‹Ð²Ð¾Ð²'}
                )
            st.plotly_chart(fig_cat, use_container_width=True)

        # Ð”Ð¸Ð½Ð°Ð¼Ð¸ÐºÐ° Ð¾Ñ‚Ð·Ñ‹Ð²Ð¾Ð² Ð¿Ð¾ Ð´Ð°Ñ‚Ð°Ð¼ (Ð»Ð¾Ð¼Ð°Ð½Ð°Ñ Ð»Ð¸Ð½Ð¸Ñ, Ð³Ñ€ÑƒÐ¿Ð¿Ð¸Ñ€Ð¾Ð²ÐºÐ° Ð¿Ð¾ Ñ‚ÐµÐ¼Ð°Ð¼)
        st.subheader("ðŸ“… Ð”Ð¸Ð½Ð°Ð¼Ð¸ÐºÐ° Ð¾Ñ‚Ð·Ñ‹Ð²Ð¾Ð² Ð¿Ð¾ Ð´Ð°Ñ‚Ð°Ð¼ (Ð¿Ð¾ Ñ‚ÐµÐ¼Ð°Ð¼)")
        if not filtered_df.empty:
            exploded_df = filtered_df.assign(topic=filtered_df['topics'].str.split(', ')).explode('topic')
            if not selected_categories:
                # ÐÐ³Ñ€ÐµÐ³Ð¸Ñ€ÑƒÐµÐ¼ Ð¿Ð¾ Ð¾ÑÐ½Ð¾Ð²Ð½Ñ‹Ð¼ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸ÑÐ¼, ÐµÑÐ»Ð¸ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸ Ð½Ðµ Ð²Ñ‹Ð±Ñ€Ð°Ð½Ñ‹
                exploded_df['topic'] = exploded_df['topic'].apply(lambda x: SUBCAT_TO_CAT.get(x.strip(), x) if x != 'Ð”Ñ€ÑƒÐ³Ð¾Ðµ' else x)
                exploded_df = exploded_df[exploded_df['topic'] != 'Ð”Ñ€ÑƒÐ³Ð¾Ðµ']  # Ð£Ð´Ð°Ð»ÑÐµÐ¼ 'Ð”Ñ€ÑƒÐ³Ð¾Ðµ'
            exploded_df['date_str'] = exploded_df['date'].dt.date.astype(str)
            count_by_date_topic = exploded_df.groupby(['date_str', 'topic']).size().reset_index(name='count')
            fig_date = px.line(
                count_by_date_topic,
                x='date_str',
                y='count',
                color='topic',
                title="Ð”Ð¸Ð½Ð°Ð¼Ð¸ÐºÐ° ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð° Ð¾Ñ‚Ð·Ñ‹Ð²Ð¾Ð² Ð¿Ð¾ Ð´Ð°Ñ‚Ð°Ð¼ Ð¸ Ñ‚ÐµÐ¼Ð°Ð¼",
                labels={'date_str': 'Ð”Ð°Ñ‚Ð°', 'count': 'ÐšÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð¾Ñ‚Ð·Ñ‹Ð²Ð¾Ð²', 'topic': 'Ð¢ÐµÐ¼Ð°'},
                color_discrete_map={
                    'ÐŸÐ¾Ð²ÑÐµÐ´Ð½ÐµÐ²Ð½Ñ‹Ðµ Ñ„Ð¸Ð½Ð°Ð½ÑÑ‹ Ð¸ Ð¿Ð»Ð°Ñ‚ÐµÐ¶Ð¸': '#FF9999',
                    'Ð¡Ð±ÐµÑ€ÐµÐ¶ÐµÐ½Ð¸Ñ Ð¸ Ð½Ð°ÐºÐ¾Ð¿Ð»ÐµÐ½Ð¸Ñ': '#66B2FF',
                    'ÐšÑ€ÐµÐ´Ð¸Ñ‚Ð¾Ð²Ð°Ð½Ð¸Ðµ': '#99FF99',
                    'Ð˜Ð½Ð²ÐµÑÑ‚Ð¸Ñ†Ð¸Ð¸': '#FFCC99',
                    'Ð¡Ñ‚Ñ€Ð°Ñ…Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¸ Ð·Ð°Ñ‰Ð¸Ñ‚Ð°': '#FF99CC',
                    'ÐŸÑ€ÐµÐ¼Ð¸Ð°Ð»ÑŒÐ½Ñ‹Ðµ ÑƒÑÐ»ÑƒÐ³Ð¸': '#C2C2F0'
                } if not selected_categories else None
            )
            st.plotly_chart(fig_date, use_container_width=True)
    else:
        st.write("ÐÐµÑ‚ Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð´Ð»Ñ Ð°Ð½Ð°Ð»Ð¸Ð·Ð°.")
else:
    st.sidebar.warning("Ð—Ð°Ð³Ñ€ÑƒÐ·Ð¸Ñ‚Ðµ JSON Ñ Ð¾Ñ‚Ð·Ñ‹Ð²Ð°Ð¼Ð¸ Ð´Ð»Ñ Ð°Ð½Ð°Ð»Ð¸Ð·Ð°")
    st.write("Ð—Ð°Ð³Ñ€ÑƒÐ·Ð¸Ñ‚Ðµ JSON Ñ Ð¾Ñ‚Ð·Ñ‹Ð²Ð°Ð¼Ð¸ Ð² ÑÐ°Ð¹Ð´Ð±Ð°Ñ€Ðµ.")
